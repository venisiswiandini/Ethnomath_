<!doctype html>
<html lang="id">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ETHNOMATH - Ethnomathematics Twin Shapes</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&amp;display=swap" rel="stylesheet">
  <style>
        body {
            box-sizing: border-box;
            background: url('https://i.imgur.com/tSUqoTm.png') center center no-repeat, linear-gradient(135deg, #FF6B9D 0%, #FEC163 25%, #A8E6CF 50%, #FFD93D 75%, #FF6B9D 100%);
            background-size: cover;
            background-attachment: fixed;
            min-height: 100%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @media (max-width: 768px) {
            body {
                background-attachment: scroll;
            }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
        }

        .neon-button {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 25%, #FF8C00 50%, #FF6347 75%, #FF4500 100%);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9);
            border: 3px solid rgba(255, 215, 0, 0.6);
            color: black;
            font-weight: bold;
            padding: 12px 24px;
            border-radius: 25px;
            transition: all 0.3s ease;
        }
        
        .neon-button:hover {
            background: linear-gradient(135deg, #FFA500 0%, #FF8C00 25%, #FF6347 50%, #FF4500 75%, #DC143C 100%);
            transform: scale(1.05);
        }

        .game-title {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4, #FFEAA7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .bounce-in-3d {
            animation: bounceIn3D 1s ease-out;
        }

        @keyframes bounceIn3D {
            0% {
                transform: scale3d(0.3, 0.3, 0.3);
                opacity: 0;
            }
            50% {
                transform: scale3d(1.1, 1.1, 1.1);
                opacity: 1;
            }
            100% {
                transform: scale3d(1, 1, 1);
                opacity: 1;
            }
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
        }

        .quiz-option {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .quiz-option:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .quiz-option.correct {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            animation: correctAnswer 0.5s ease;
        }

        .quiz-option.incorrect {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
            animation: incorrectAnswer 0.5s ease;
        }

        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectAnswer {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        @keyframes popupBounce {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        @keyframes popupFadeOut {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
        }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            z-index: 9999;
            animation: confetti 3s ease-out forwards;
        }

        @keyframes slideUpFade {
            0% {
                opacity: 0;
                transform: translateY(30px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-up {
            animation: slideUpFade 0.6s ease-out forwards;
        }

        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        @media (max-width: 768px) {
            .glass-card {
                margin: 8px;
                padding: 16px !important;
            }
            
            .text-6xl {
                font-size: 2.5rem !important;
            }
            
            .text-5xl {
                font-size: 2rem !important;
            }
            
            .text-4xl {
                font-size: 1.75rem !important;
            }
            
            .text-3xl {
                font-size: 1.5rem !important;
            }
            
            .text-2xl {
                font-size: 1.25rem !important;
            }
            
            .text-xl {
                font-size: 1.1rem !important;
            }
            
            button, .neon-button {
                min-height: 48px !important;
                padding: 12px 16px !important;
                font-size: 16px !important;
            }
            
            .space-y-6 > * + * {
                margin-top: 1rem !important;
            }
            
            .space-y-4 > * + * {
                margin-top: 0.75rem !important;
            }
            
            .grid.grid-cols-2 {
                gap: 0.75rem !important;
            }
            
            .grid.grid-cols-4 {
                grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
            }
            
            .p-8 {
                padding: 1.25rem !important;
            }
            
            .p-6 {
                padding: 1rem !important;
            }
            
            .p-4 {
                padding: 0.75rem !important;
            }
            
            .max-w-4xl,
            .max-w-2xl {
                max-width: 100% !important;
                margin-left: 0.5rem !important;
                margin-right: 0.5rem !important;
            }
            
            img {
                max-width: 100% !important;
                height: auto !important;
                display: block;
            }
            
            .slide-content img,
            #quizContent img {
                max-width: 100% !important;
                width: auto !important;
                height: auto !important;
                object-fit: contain !important;
            }
            
            .slide-content,
            #quizContent {
                overflow-x: hidden;
                max-width: 100%;
            }
            
            .quiz-option {
                padding: 0.75rem !important;
                font-size: 0.95rem !important;
            }
            
            #memoryBoard {
                gap: 0.5rem !important;
            }
            
            .max-w-md {
                max-width: 95% !important;
            }
            
            .max-w-2xl {
                max-width: 95% !important;
            }
            
            .max-w-4xl {
                max-width: 95% !important;
            }
            
            .overflow-x-auto {
                -webkit-overflow-scrolling: touch;
            }
            
            .grid.grid-cols-2.md\\:grid-cols-4 {
                grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
                gap: 0.75rem !important;
            }
            
            .flex.flex-wrap.gap-2 {
                gap: 0.5rem !important;
            }
            
            .tab-button {
                padding: 0.75rem 1rem !important;
                font-size: 0.9rem !important;
            }
        }
        
        @media (max-width: 374px) {
            .text-6xl {
                font-size: 2rem !important;
            }
            
            .text-4xl {
                font-size: 1.5rem !important;
            }
            
            .text-3xl {
                font-size: 1.25rem !important;
            }
            
            .grid.grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            
            #memoryBoard {
                grid-template-columns: repeat(3, minmax(0, 1fr)) !important;
            }
        }
        
        .tab-button.active {
            color: #3B82F6;
            border-bottom-color: #3B82F6 !important;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="min-h-screen"><!-- Background Music -->
  <audio id="backgroundMusic" loop preload="auto"><source src="https://raw.githubusercontent.com/venisiswiandini/Ethnomath_/refs/heads/main/BS.mp3" type="audio/mpeg">
  </audio><!-- Enhanced Audio Control Button - Top Right --> <button id="audioButton" class="fixed top-4 right-4 z-50 neon-button rounded-full shadow-2xl flex items-center justify-center" style="z-index: 99999 !important; position: fixed !important; width: 56px !important; height: 56px !important; min-width: 56px !important; min-height: 56px !important; max-width: 56px !important; max-height: 56px !important; padding: 12px !important;" onclick="toggleAudio()">
   <svg id="audioIcon" class="w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" viewbox="0 0 24 24" style="width: 24px !important; height: 24px !important;"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>
   </svg></button> <!-- Connection Status Indicator - Top Right (below audio button) -->
  <div id="connectionStatus" class="fixed top-20 right-4 z-50 bg-white/90 backdrop-blur-sm rounded-full px-3 py-2 shadow-lg border-2 border-gray-200" style="z-index: 99999 !important; position: fixed !important;">
   <div class="flex items-center space-x-2">
    <div id="connectionDot" class="w-3 h-3 rounded-full bg-yellow-500 animate-pulse"></div><span id="connectionText" class="text-xs font-bold text-gray-700">Testing...</span>
   </div>
  </div><!-- Host Button - Bottom Left --> <button id="hostButton" class="fixed bottom-4 left-4 z-50 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 hover:scale-110" style="z-index: 99999 !important; position: fixed !important; width: 56px !important; height: 56px !important; min-width: 56px !important; min-height: 56px !important; max-width: 56px !important; max-height: 56px !important; padding: 12px !important;" onclick="showHostLogin()">
   <svg class="w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" viewbox="0 0 24 24" style="width: 24px !important; height: 24px !important;"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
   </svg></button> <!-- Host Login Modal -->
  <div id="hostLoginModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4" style="z-index: 99999 !important;">
   <div class="glass-card rounded-3xl p-8 max-w-md mx-auto w-full" style="animation: popupBounce 0.5s ease-out;">
    <div class="text-center mb-6">
     <div class="text-6xl mb-4">
      üîê
     </div>
     <h2 class="text-3xl font-bold text-white mb-2">Host Login</h2>
     <p class="text-lg text-white/80">Masukkan password untuk akses dashboard</p>
    </div>
    <div class="bg-white/95 rounded-2xl p-6 shadow-2xl">
     <div class="mb-4"><label for="hostPassword" class="block text-lg font-bold text-gray-800 mb-3">üîë Password:</label> <input type="password" id="hostPassword" class="w-full px-6 py-4 text-lg border-3 border-gray-300 rounded-2xl focus:border-purple-500 focus:outline-none text-center font-semibold bg-white shadow-lg" placeholder="Masukkan password" onkeypress="if(event.key==='Enter') submitHostLogin()">
     </div>
     <div id="hostLoginError" class="hidden mb-4 p-4 bg-red-100 rounded-xl text-center">
      <p class="text-red-800 font-bold">‚ùå Password salah!</p>
     </div>
     <div class="space-y-3"><button class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-8 py-4 rounded-full font-bold text-lg" onclick="submitHostLogin()"> üîì Login </button> <button class="w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-8 py-4 rounded-full font-bold text-lg" onclick="closeHostLogin()"> ‚ùå Batal </button>
     </div>
    </div>
   </div>
  </div><!-- Name Input Page -->
  <div id="nameInputPage" class="hidden min-h-screen flex items-center justify-center p-4">
   <div class="glass-card rounded-3xl p-8 max-w-md mx-auto w-full">
    <div class="text-center mb-8">
     <h2 class="text-3xl md:text-4xl font-bold mb-4 game-title">üìù Masukkan Nama</h2>
     <div class="text-4xl md:text-6xl mb-4 floating">
      üë§
     </div>
     <p class="text-lg md:text-xl text-white">Siapa nama kamu?</p>
    </div>
    <div class="bg-white/95 rounded-3xl p-6 shadow-2xl">
     <div class="mb-6"><label for="nameInput" class="block text-lg font-bold text-gray-800 mb-3 text-center">üåü Nama Lengkap Kamu:</label> <input type="text" id="nameInput" class="w-full px-6 py-4 text-lg border-3 border-gray-300 rounded-2xl focus:border-blue-500 focus:outline-none text-center font-semibold bg-white shadow-lg" placeholder="Masukkan nama kamu" maxlength="50" onkeypress="if(event.key==='Enter') submitNameFromPage()" oninput="checkNameInput()" style="z-index: 99999 !important;">
     </div>
     <div id="nameWarning" class="hidden mb-4 p-4 bg-yellow-100 rounded-xl text-center">
      <p class="text-yellow-800 font-bold">‚ö†Ô∏è Silakan isi nama terlebih dahulu!</p>
     </div>
     <div class="space-y-4"><button id="startActivityBtn" class="w-full neon-button text-black px-8 py-4 rounded-full font-bold text-lg disabled:opacity-50" onclick="submitNameFromPage()" disabled style="z-index: 99999 !important;"> üöÄ Mulai </button> <button class="w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-8 py-4 rounded-full font-bold text-lg" onclick="showPage('homePage')" style="z-index: 99999 !important;"> ‚¨ÖÔ∏è Kembali ke Beranda </button>
     </div>
    </div>
   </div>
  </div><!-- Home Page -->
  <div id="homePage" class="min-h-screen flex items-center justify-center p-4">
   <div class="max-w-4xl mx-auto text-center w-full">
    <div class="glass-card rounded-3xl p-8 shadow-2xl bounce-in-3d card-hover">
     <div class="mb-8">
      <div class="text-6xl mb-4 floating">
       üéÆüåàüìê‚ú®
      </div>
      <div class="flex justify-center mb-8">
       <div class="relative group w-full max-w-2xl">
        <div class="absolute -inset-6 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 rounded-3xl blur-2xl opacity-30 group-hover:opacity-50 transition-all duration-500 animate-pulse"></div>
        <div class="relative glass-card rounded-3xl p-4 md:p-8 border-2 border-white/20 shadow-2xl">
         <div class="text-center bg-gradient-to-r from-yellow-600 to-orange-600 text-white p-4 md:p-8 rounded-2xl"><img src="https://i.imgur.com/sWMWajt.png" alt="ETHNOMATH Twin Shapes by Veni Siswiandini" class="w-full h-auto max-h-64 md:max-h-96 object-contain rounded-lg mx-auto" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\'text-6xl mb-4\'>üéì</div><h3 class=\'text-2xl font-bold text-white\'>ETHNOMATH</h3><p class=\'text-lg text-white\'>Twin Shapes by Veni Siswiandini</p>';" style="max-width: 100%;">
         </div>
        </div>
       </div>
      </div>
      <div class="text-2xl font-bold mb-6 text-center game-title">
       <div id="appTitle" style="font-family: 'Orbitron', monospace; font-weight: 600; font-size: 2.2rem; color: #FFFFFF; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
        ETHNOMATH Twin Shapes
       </div>
       <div style="font-family: 'Orbitron', monospace; font-weight: 600; font-size: 1.2rem; color: #FFFFFF; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
        by Veni Siswiandini
       </div>
      </div>
      <div class="text-3xl mb-6 floating">
       üéØüé™üöÄüéä
      </div>
     </div><!-- Feature Cards -->
     <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
      <div class="glass-card rounded-2xl p-6 card-hover" style="border: 3px solid rgba(255, 107, 157, 0.8); background: linear-gradient(135deg, rgba(255, 107, 157, 0.3), rgba(255, 182, 193, 0.3));">
       <div class="text-5xl floating mb-3">
        üé≤
       </div>
       <div class="text-xl font-bold" style="color: #FF1493;">
        Seru &amp;
       </div>
       <div class="text-lg text-white font-bold">
        Menarik!
       </div>
      </div>
      <div class="glass-card rounded-2xl p-6 card-hover" style="border: 3px solid rgba(168, 230, 207, 0.8); background: linear-gradient(135deg, rgba(168, 230, 207, 0.3), rgba(144, 238, 144, 0.3));">
       <div class="text-5xl floating mb-3">
        ‚è∞
       </div>
       <div class="text-xl font-bold" style="color: #00C853;">
        Interaktif
       </div>
       <div class="text-lg text-white font-bold">
        Seru!
       </div>
      </div>
      <div class="glass-card rounded-2xl p-6 card-hover" style="border: 3px solid rgba(255, 217, 61, 0.8); background: linear-gradient(135deg, rgba(255, 217, 61, 0.3), rgba(255, 235, 59, 0.3));">
       <div class="text-5xl floating mb-3">
        üèÜ
       </div>
       <div class="text-xl font-bold" style="color: #FF6F00;">
        Budaya
       </div>
       <div class="text-lg text-white font-bold">
        Melayu
       </div>
      </div>
      <div class="glass-card rounded-2xl p-6 card-hover" style="border: 3px solid rgba(186, 104, 200, 0.8); background: linear-gradient(135deg, rgba(186, 104, 200, 0.3), rgba(171, 71, 188, 0.3));">
       <div class="text-5xl floating mb-3">
        üé®
       </div>
       <div class="text-xl font-bold" style="color: #AA00FF;">
        Animasi
       </div>
       <div class="text-lg text-white font-bold">
        Keren!
       </div>
      </div>
     </div><!-- Main Menu Buttons -->
     <div class="space-y-6"><button class="w-full bg-gradient-to-r from-pink-400 via-rose-400 to-red-400 hover:from-pink-500 hover:via-rose-500 hover:to-red-500 text-white px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-2xl" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3);" onclick="showMaterial()"> üìñ Materi Pembelajaran üìö </button> <button class="w-full bg-gradient-to-r from-lime-400 via-green-400 to-emerald-500 hover:from-lime-500 hover:via-green-500 hover:to-emerald-600 text-white px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-2xl" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3);" onclick="showQuiz()"> üöÄ Latihan Soal üéÆ </button> <button class="w-full bg-gradient-to-r from-yellow-400 via-orange-400 to-pink-500 hover:from-yellow-500 hover:via-orange-500 hover:to-pink-600 text-white px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-2xl" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3);" onclick="showMemoryGame()"> üéÆ Cocokin Yuk! üß© </button>
     </div><!-- Footer -->
     <div class="mt-8 text-center">
      <div id="welcomeMessage" class="text-lg font-bold mb-4" style="color: #000000; text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9);">
       üåü Belajar Matematika Jadi Menyenangkan! üåü
      </div>
      <div class="flex justify-center space-x-3 text-3xl"><span class="animate-bounce floating">üéâ</span> <span class="animate-bounce floating">üéä</span> <span class="animate-bounce floating">üéà</span> <span class="animate-bounce floating">üéÅ</span> <span class="animate-bounce floating">üé™</span>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Global Variables
        let isAudioPlaying = false;
        let currentQuestionIndex = 0;
        let quizScore = 0;
        let quizTimer = null;
        let quizTimeRemaining = 1800;
        let gameTimer = null;
        let gameTime = 0;
        let memoryCards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let gameAttempts = 0;
        let userName = '';
        let isHostLoggedIn = false;
        
        // Google Apps Script URL - NEW DEPLOYMENT
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz6G3SGO_9hayXHrlHy-ciQD0xt1qRpy6emPhGTpdNbaMHjnUlXFgG_oUgLHajIJDtORg/exec';
        
        // Host Data Storage (local cache)
        let hostData = {
            users: [],
            quizResults: [],
            gameResults: [],
            materialActivities: []
        };

        // Configuration object for editable features
        const defaultConfig = {
            app_title: "ETHNOMATH Twin Shapes",
            welcome_message: "üåü Belajar Matematika Jadi Menyenangkan! üåü"
        };

        // Test Connection to Google Sheets
        async function testConnection() {
            const statusDot = document.getElementById('connectionDot');
            const statusText = document.getElementById('connectionText');
            
            try {
                statusDot.className = 'w-3 h-3 rounded-full bg-yellow-500 animate-pulse';
                statusText.textContent = 'Testing...';
                
                // Use POST method to avoid CORS preflight issues
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        action: 'testConnection'
                    })
                });
                
                // With no-cors mode, we can't read the response
                // So we assume success if no error is thrown
                statusDot.className = 'w-3 h-3 rounded-full bg-green-500';
                statusText.textContent = 'Online';
                console.log('‚úÖ Connection successful!');
                return true;
            } catch (error) {
                console.error('‚ùå Connection error:', error);
                statusDot.className = 'w-3 h-3 rounded-full bg-red-500';
                statusText.textContent = 'Offline';
                return false;
            }
        }

        // Audio Control Functions
        function toggleAudio() {
            const audio = document.getElementById('backgroundMusic');
            const audioIcon = document.getElementById('audioIcon');
            
            if (isAudioPlaying) {
                audio.pause();
                isAudioPlaying = false;
                audioIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path>';
            } else {
                audio.play().catch(e => console.log('Audio play failed:', e));
                isAudioPlaying = true;
                audioIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>';
            }
        }

        // Page Navigation
        function showPage(pageId) {
            const pages = ['homePage', 'nameInputPage', 'materialPage', 'quizPage', 'memoryGamePage', 'hostDashboard'];
            pages.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.add('hidden');
                }
            });
            
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.remove('hidden');
            }
        }

        // Name Input Functions
        function checkNameInput() {
            const nameInput = document.getElementById('nameInput');
            const startBtn = document.getElementById('startActivityBtn');
            const warning = document.getElementById('nameWarning');
            
            if (nameInput.value.trim().length > 0) {
                startBtn.disabled = false;
                warning.classList.add('hidden');
            } else {
                startBtn.disabled = true;
            }
        }

        function submitNameFromPage() {
            const nameInput = document.getElementById('nameInput');
            const name = nameInput.value.trim();
            const warning = document.getElementById('nameWarning');
            
            if (name === '') {
                warning.classList.remove('hidden');
                return;
            }
            
            userName = name;
            saveUserToSheet(name);
            showPage('homePage');
            updateWelcomeMessage();
        }

        function updateWelcomeMessage() {
            const welcomeMsg = document.getElementById('welcomeMessage');
            if (userName) {
                welcomeMsg.innerHTML = `üåü Selamat Datang, <strong>${userName}</strong>! üåü`;
            }
        }

        // Save user to Google Sheets
        async function saveUserToSheet(name) {
            try {
                const data = {
                    action: 'addUser',
                    name: name,
                    deviceId: getDeviceId(),
                    timestamp: new Date().toLocaleString('id-ID')
                };
                
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                console.log('User saved:', result);
            } catch (error) {
                console.error('Error saving user:', error);
            }
        }

        // Get Device ID
        function getDeviceId() {
            let deviceId = localStorage.getItem('deviceId');
            if (!deviceId) {
                deviceId = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('deviceId', deviceId);
            }
            return deviceId;
        }

        // Host Login Functions
        function showHostLogin() {
            document.getElementById('hostLoginModal').classList.remove('hidden');
            document.getElementById('hostPassword').value = '';
            document.getElementById('hostLoginError').classList.add('hidden');
        }

        function closeHostLogin() {
            document.getElementById('hostLoginModal').classList.add('hidden');
        }

        function submitHostLogin() {
            const password = document.getElementById('hostPassword').value;
            const errorDiv = document.getElementById('hostLoginError');
            
            if (password === 'admin123') {
                isHostLoggedIn = true;
                closeHostLogin();
                showHostDashboard();
            } else {
                errorDiv.classList.remove('hidden');
            }
        }

        // Show Material
        function showMaterial() {
            if (!userName) {
                showPage('nameInputPage');
                return;
            }
            alert('Materi akan segera ditampilkan!');
        }

        // Show Quiz
        function showQuiz() {
            if (!userName) {
                showPage('nameInputPage');
                return;
            }
            alert('Quiz akan segera ditampilkan!');
        }

        // Show Memory Game
        function showMemoryGame() {
            if (!userName) {
                showPage('nameInputPage');
                return;
            }
            alert('Memory game akan segera ditampilkan!');
        }

        // Show Host Dashboard
        function showHostDashboard() {
            if (!isHostLoggedIn) {
                showHostLogin();
                return;
            }
            alert('Dashboard host akan segera ditampilkan!');
        }

        // Initialize on page load
        window.addEventListener('load', function() {
            showPage('homePage');
            testConnection();
            // Test connection every 30 seconds
            setInterval(testConnection, 30000);
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99cc1e91b3595fe5',t:'MTc2Mjg0NjU5NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
