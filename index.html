<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ETHNOMATH - Ethnomathematics Twin Shapes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        
        /* Enhanced Glass Card Effect */
        .glass-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
        }

        /* Enhanced Neon Button */
        .neon-button {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 25%, #FF8C00 50%, #FF6347 75%, #FF4500 100%);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4), inset 0 2px 0 rgba(255, 255, 255, 0.3);
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9), 1px 1px 2px rgba(255, 255, 255, 0.8), 0 0 6px rgba(255, 255, 255, 0.6);
            border: 3px solid rgba(255, 215, 0, 0.6);
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        /* Global button improvements */
        button {
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            outline: none;
            border: none;
            z-index: 100 !important;
            position: relative !important;
            pointer-events: auto !important;
        }
        
        button:focus {
            outline: 2px solid #3B82F6;
            outline-offset: 2px;
        }
        
        button:active {
            transform: scale(0.98);
        }

        .neon-button:hover {
            background: linear-gradient(135deg, #FFA500 0%, #FF8C00 25%, #FF6347 50%, #FF4500 75%, #DC143C 100%);
            box-shadow: 0 15px 40px rgba(255, 165, 0, 0.6), inset 0 2px 0 rgba(255, 255, 255, 0.4);
        }

        /* Enhanced Neon Text */
        .neon-text {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 0 0 20px rgba(255, 255, 255, 0.6), 0 0 30px rgba(255, 255, 255, 0.4);
        }

        /* Enhanced Glow Effect */
        .glow-effect {
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3), 0 0 40px rgba(255, 255, 255, 0.2), 0 0 60px rgba(255, 255, 255, 0.1);
        }

        /* Enhanced Holographic Effect */
        .holographic {
            background: linear-gradient(45deg, rgba(255, 0, 150, 0.1), rgba(0, 255, 255, 0.1), rgba(255, 255, 0, 0.1), rgba(255, 0, 150, 0.1));
            background-size: 400% 400%;
            animation: holographic 4s ease-in-out infinite;
        }

        @keyframes holographic {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Simplified floating animation for mobile */
        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @media (max-width: 768px) {
            .floating {
                animation: none !important;
            }
        }

        /* Enhanced Bounce-in-3D Animation */
        .bounce-in-3d {
            animation: bounceIn3D 1s ease-out;
        }

        @keyframes bounceIn3D {
            0% {
                transform: scale3d(0.3, 0.3, 0.3) rotateX(20deg) rotateY(20deg);
                opacity: 0;
            }
            20% {
                transform: scale3d(1.1, 1.1, 1.1) rotateX(-10deg) rotateY(-10deg);
            }
            40% {
                transform: scale3d(0.9, 0.9, 0.9) rotateX(5deg) rotateY(5deg);
            }
            60% {
                transform: scale3d(1.03, 1.03, 1.03) rotateX(-2deg) rotateY(-2deg);
                opacity: 1;
            }
            80% {
                transform: scale3d(0.97, 0.97, 0.97) rotateX(1deg) rotateY(1deg);
            }
            100% {
                transform: scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg);
                opacity: 1;
            }
        }

        /* Enhanced Card Hover Effect */
        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
        }

        /* Enhanced Slide Animations */
        .slide-in-left {
            animation: slideInLeft 0.8s ease-out;
        }

        .slide-in-right {
            animation: slideInRight 0.8s ease-out;
        }

        .slide-in-up {
            animation: slideInUp 0.8s ease-out;
        }

        .slide-in-down {
            animation: slideInDown 0.8s ease-out;
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideInDown {
            from {
                transform: translateY(-100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Enhanced Game Title */
        .game-title {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4, #FFEAA7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 3s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(180deg); }
        }

        /* Enhanced Background */
        body {
            background: url('https://i.imgur.com/tSUqoTm.png') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Background overlay for better readability */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: -1;
            pointer-events: none !important;
        }

        /* Mobile background adjustments */
        @media (max-width: 768px) {
            body {
                background-attachment: scroll;
                background-size: cover;
                background-position: center center;
            }
        }

        @media (max-width: 480px) {
            body {
                background-size: cover;
                background-position: center center;
            }
        }

        /* Tablet background adjustments */
        @media (min-width: 481px) and (max-width: 1024px) {
            body {
                background-size: cover;
                background-position: center center;
            }
        }

        /* Desktop background adjustments */
        @media (min-width: 1025px) {
            body {
                background-size: cover;
                background-position: center center;
            }
        }

        /* Simplified background effects for mobile performance */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -2;
            pointer-events: none !important;
        }

        /* Disable matrix rain on mobile for better performance */
        .matrix-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none !important;
            z-index: -1;
            overflow: hidden;
        }

        @media (max-width: 768px) {
            .matrix-rain {
                display: none !important;
            }
            
            #particles-js {
                display: none !important;
            }
        }

        .matrix-drop {
            position: absolute;
            color: rgba(0, 255, 0, 0.3);
            font-family: 'Courier New', monospace;
            font-size: 14px;
            animation: matrixFall linear infinite;
        }

        @keyframes matrixFall {
            0% {
                transform: translateY(-100vh);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh);
                opacity: 0;
            }
        }

        /* Enhanced Progress Bar */
        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #4CAF50, #8BC34A, #CDDC39);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        /* Enhanced Memory Game Board */
        .memory-game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 800px;
            margin: 0 auto;
        }

        .memory-card {
            aspect-ratio: 1;
            border-radius: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background: #f8f9fa;
            padding: 4px;
            z-index: 100 !important;
            pointer-events: auto !important;
        }

        .memory-card img {
            width: 95%;
            height: 95%;
            max-width: 95%;
            max-height: 95%;
            object-fit: contain;
            object-position: center;
            border-radius: 10px;
        }

        .memory-card:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .memory-card.flipped {
            border: 3px solid #FFD700;
        }

        .memory-card.matched {
            border: 3px solid #4CAF50;
            cursor: default;
            opacity: 0.8;
        }

        /* Enhanced Slide Indicators */
        .slide-indicator {
            transition: all 0.3s ease;
            z-index: 100 !important;
            pointer-events: auto !important;
        }

        .slide-indicator.active {
            background-color: #3B82F6 !important;
            transform: scale(1.2);
        }

        .slide-indicator:hover {
            transform: scale(1.1);
        }

        /* Enhanced Responsive Design */
        @media (max-width: 768px) {
            body {
                overflow-x: hidden;
                -webkit-overflow-scrolling: touch;
            }
            
            .memory-game-board {
                grid-template-columns: repeat(4, 1fr);
                gap: 6px;
                max-width: 100%;
                padding: 0 8px;
            }
            
            .memory-card {
                padding: 2px;
                min-height: 75px;
                border-radius: 8px;
            }
            
            .memory-card img {
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 100%;
                object-fit: contain;
                border-radius: 6px;
            }
            
            .glass-card {
                margin: 6px;
                padding: 1rem;
                border-radius: 20px;
            }
            
            .slide-content img {
                max-height: 180px !important;
                width: 100% !important;
                object-fit: contain !important;
            }
            
            /* Mobile button improvements */
            button {
                min-height: 44px;
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
                font-size: 14px;
                padding: 12px 16px;
                border-radius: 12px;
            }
            
            .neon-button {
                padding: 16px 20px;
                font-size: 16px;
                line-height: 1.2;
                border-radius: 25px;
            }
            
            .quiz-option {
                padding: 14px 18px;
                font-size: 14px;
                line-height: 1.4;
                margin: 6px 0;
                border-radius: 15px;
            }
            
            /* Text scaling for mobile */
            .game-title {
                font-size: 1.6rem;
                line-height: 1.2;
            }
            
            h2 {
                font-size: 1.4rem;
                line-height: 1.3;
            }
            
            h3 {
                font-size: 1.2rem;
                line-height: 1.3;
            }
            
            /* Container spacing */
            .min-h-screen {
                padding: 8px;
            }
        }

        @media (max-width: 480px) {
            .memory-game-board {
                grid-template-columns: repeat(4, 1fr);
                gap: 6px;
                max-width: 100%;
                padding: 0 5px;
            }
            
            .memory-card {
                padding: 1px;
                min-height: 70px;
            }
            
            .memory-card img {
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 100%;
                object-fit: contain;
            }
            
            .slide-content img {
                max-height: 180px !important;
                width: 100% !important;
                object-fit: contain !important;
            }
            
            .glass-card {
                padding: 0.75rem;
                margin: 5px;
            }
            
            /* Small mobile button improvements */
            button {
                min-height: 44px;
                padding: 12px 16px;
                font-size: 13px;
            }
            
            .neon-button {
                padding: 16px 20px;
                font-size: 15px;
                font-weight: 700;
            }
            
            .quiz-option {
                padding: 14px 16px;
                font-size: 13px;
                margin: 6px 0;
                line-height: 1.3;
            }
            
            /* Smaller text for very small screens */
            .game-title {
                font-size: 1.5rem;
            }
            
            h2 {
                font-size: 1.3rem;
            }
            
            h3 {
                font-size: 1.1rem;
            }
            
            /* Floating elements smaller on mobile */
            .floating {
                font-size: 2rem;
            }
        }

        /* Enhanced image sizing for all devices */
        img {
            max-width: 100%;
            height: auto;
            object-fit: contain;
            display: block;
            margin: 0 auto;
        }

        /* Ensure all interactive elements are clickable */
        .glass-card,
        #homePage,
        #materialPage,
        #memoryGamePage,
        #nameInputPage,
        #hostLoginPage,
        #memoryGameBoard,
        .quiz-option,
        .memory-card,
        input,
        textarea,
        select {
            position: relative !important;
            z-index: 10 !important;
            pointer-events: auto !important;
        }

        /* Dashboard Styles */
        .dashboard-tab {
            transition: all 0.3s ease;
            z-index: 100 !important;
            pointer-events: auto !important;
        }
        
        .dashboard-tab.active {
            background: linear-gradient(135deg, #3B82F6 0%, #6366F1 100%) !important;
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }
        
        .dashboard-content {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Enhanced Quiz Styles */
        .quiz-option {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.95) 100%);
            border: 3px solid transparent;
            border-radius: 20px;
            padding: 20px 25px;
            margin: 12px 0;
            cursor: pointer;
            transition: all 0.4s ease;
            font-weight: 700;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            font-size: 16px;
            line-height: 1.5;
            z-index: 100 !important;
            pointer-events: auto !important;
        }

        .quiz-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s;
        }

        .quiz-option:hover::before {
            left: 100%;
        }

        .quiz-option:hover {
            background: linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%);
            border: 3px solid;
            border-image: linear-gradient(135deg, #3B82F6, #8B5CF6, #EC4899) 1;
            transform: translateX(15px) scale(1.02);
            box-shadow: 0 15px 35px rgba(59, 130, 246, 0.3);
        }

        .quiz-option.selected {
            background: linear-gradient(135deg, #3B82F6 0%, #8B5CF6 50%, #EC4899 100%);
            color: white;
            border: 3px solid #1D4ED8;
            transform: translateX(10px) scale(1.05);
            box-shadow: 0 20px 40px rgba(59, 130, 246, 0.4);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .quiz-option.correct {
            background: linear-gradient(135deg, #10B981 0%, #059669 50%, #047857 100%);
            color: white;
            border: 3px solid #059669;
            transform: translateX(10px) scale(1.05);
            box-shadow: 0 20px 40px rgba(16, 185, 129, 0.4);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            animation: correctPulse 0.6s ease-in-out;
        }

        .quiz-option.incorrect {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 50%, #B91C1C 100%);
            color: white;
            border: 3px solid #DC2626;
            transform: translateX(10px) scale(1.05);
            box-shadow: 0 20px 40px rgba(239, 68, 68, 0.4);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            animation: incorrectShake 0.6s ease-in-out;
        }

        @keyframes correctPulse {
            0% { transform: translateX(10px) scale(1.05); }
            50% { transform: translateX(10px) scale(1.1); box-shadow: 0 25px 50px rgba(16, 185, 129, 0.6); }
            100% { transform: translateX(10px) scale(1.05); }
        }

        @keyframes incorrectShake {
            0%, 100% { transform: translateX(10px) scale(1.05); }
            25% { transform: translateX(5px) scale(1.05); }
            75% { transform: translateX(15px) scale(1.05); }
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Background Audio -->
    <audio id="backgroundAudio" loop preload="auto" crossorigin="anonymous">
        <source src="https://raw.githubusercontent.com/venisiswiandini/Ethnomath_/refs/heads/main/BS.mp3" type="audio/mpeg">
        <source src="https://github.com/venisiswiandini/Ethnomath_/raw/main/BS.mp3" type="audio/mpeg">
        Browser Anda tidak mendukung audio.
    </audio>

    <!-- Particle Background -->
    <div id="particles-js"></div>

    <!-- Matrix Rain Effect -->
    <div id="matrixRain" class="matrix-rain"></div>

    <!-- Enhanced Audio Control Button - Top Right -->
    <button id="audioButton" class="fixed top-4 right-4 z-50 neon-button text-black p-4 rounded-full shadow-2xl transition-all duration-300 transform hover:scale-110 group" onclick="toggleAudio()">
        <svg id="audioIcon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>
        </svg>
        <div class="absolute bottom-full right-0 mb-2 px-3 py-1 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap">
            <span id="audioTooltip">Matikan Musik</span>
        </div>
    </button>

    <!-- Host Login Button - Bottom Left -->
    <button class="fixed bottom-4 left-4 z-50 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white p-4 rounded-full shadow-2xl transition-all duration-300 transform hover:scale-110 group" style="position: fixed !important; bottom: 1rem !important; left: 1rem !important;" onclick="playSound('click'); showHostLogin()">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
        <div class="absolute bottom-full left-0 mb-2 px-3 py-1 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap">
            Host Login
        </div>
    </button>

    <!-- Popup Modal for Slide 1 -->
    <div id="slide1PopupModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="glass-card rounded-3xl p-8 max-w-md mx-4 shadow-2xl bounce-in-3d glow-effect">
            <div class="text-center">
                <div class="text-6xl mb-4">üéâ</div>
                <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Jawaban Benar!</h3>
                <div class="bg-gradient-to-r from-green-100 to-blue-100 p-6 rounded-xl mb-6">
                    <p class="text-lg md:text-xl text-gray-700 font-semibold leading-relaxed">
                        Ya benar! Yang berbentuk segitiga adalah bagian atapnya! üè†
                    </p>
                </div>
                <div class="text-4xl mb-4">‚úÖ</div>
                <button class="neon-button text-black px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('correct'); hideSlide1Popup()">
                    üëç Mengerti!
                </button>
            </div>
        </div>
    </div>

    <!-- Popup Modal for Slide 4 -->
    <div id="slide4PopupModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="glass-card rounded-3xl p-8 max-w-md mx-4 shadow-2xl bounce-in-3d glow-effect">
            <div class="text-center">
                <div class="text-6xl mb-4">üéâ</div>
                <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Jawaban Benar!</h3>
                <div class="bg-gradient-to-r from-green-100 to-blue-100 p-6 rounded-xl mb-6">
                    <p class="text-lg md:text-xl text-gray-700 font-semibold leading-relaxed">
                        Ya benar! Semua rebana memiliki bentuk yang sebangun karena semuanya berbentuk lingkaran dengan perbandingan yang sama! ü•Å
                    </p>
                </div>
                <div class="text-4xl mb-4">‚úÖ</div>
                <button class="neon-button text-black px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('correct'); hideSlide4Popup()">
                    üëç Mengerti!
                </button>
            </div>
        </div>
    </div>

    <!-- Halaman Materi -->
    <div id="materialPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="glass-card rounded-3xl p-6 max-w-5xl mx-auto w-full">
            <!-- Header -->
            <div class="text-center mb-6">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 game-title">üìñ Materi Pembelajaran üìö</h2>
                <div class="text-4xl md:text-6xl mb-4 floating">üìö</div>
                <p class="text-lg md:text-xl text-white neon-text">Kesebangunan dalam Budaya Melayu</p>
            </div>

            <!-- Slide Container -->
            <div class="relative bg-white/95 rounded-2xl p-6 md:p-8 shadow-2xl min-h-[500px] md:min-h-[600px]">
                <!-- Slide 1 -->
                <div id="slide1" class="slide-content">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Mengenal Bentuk Segitiga</h3>
                    </div>
                    <div class="flex flex-col lg:flex-row items-center gap-6">
                        <div class="w-full lg:w-1/2">
                            <div class="bg-white p-4 rounded-xl shadow-lg cursor-pointer hover:scale-105 transition-transform duration-300" onclick="showSlide1Popup()">
                                <img src="https://i.imgur.com/1As20RS.png" alt="Rumah Adat Melayu" class="w-full h-auto max-h-64 object-contain rounded-lg mb-4" onerror="this.src=''; this.alt='Rumah Adat Melayu'; this.style.display='none';">
                            </div>
                            <p class="text-sm text-gray-600 text-center mt-2">üëÜ Klik untuk melihat jawaban!</p>
                        </div>
                        <div class="w-full lg:w-1/2 text-center lg:text-left">
                            <div class="bg-gradient-to-r from-blue-100 to-purple-100 p-6 rounded-xl">
                                <h4 class="text-xl md:text-2xl font-bold text-gray-800 mb-4">ü§î Pertanyaan:</h4>
                                <p class="text-lg md:text-xl text-gray-700 font-semibold leading-relaxed">
                                    Bagian mana dari rumah adat ini yang berbentuk segitiga?
                                </p>
                                <div class="mt-4 text-4xl">üîç</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 2 -->
                <div id="slide2" class="slide-content hidden">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Membandingkan Bentuk</h3>
                    </div>
                    <div class="flex flex-col lg:flex-row items-center gap-6">
                        <div class="w-full lg:w-1/2">
                            <div class="bg-white p-4 rounded-xl shadow-lg">
                                <img src="https://i.imgur.com/q0zRUtd.png" alt="Perbandingan Segitiga" class="w-full h-auto max-h-64 object-contain rounded-lg mb-4" onerror="this.src=''; this.alt='Perbandingan Segitiga'; this.style.display='none';">
                            </div>
                        </div>
                        <div class="w-full lg:w-1/2 text-center lg:text-left">
                            <div class="bg-gradient-to-r from-green-100 to-blue-100 p-6 rounded-xl">
                                <h4 class="text-xl md:text-2xl font-bold text-gray-800 mb-4">ü§î Pertanyaan:</h4>
                                <p class="text-lg md:text-xl text-gray-700 font-semibold leading-relaxed mb-4">
                                    Apakah segitiga putih dan segitiga merah memiliki bentuk yang sama?
                                </p>
                                <div id="slide2-buttons" class="space-y-4">
                                    <button id="slide2BtnSama" class="w-full bg-gradient-to-r from-green-500 via-emerald-500 to-teal-500 hover:from-green-600 hover:via-emerald-600 hover:to-teal-600 text-white px-6 py-4 rounded-xl font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg border-2 border-green-400 hover:shadow-xl" onclick="answerSlide2('sama')">
                                        <div class="flex items-center justify-center space-x-3">
                                            <span class="text-2xl">‚úÖ</span>
                                            <span>Sama</span>
                                            <span class="text-2xl animate-bounce">üéØ</span>
                                        </div>
                                    </button>
                                    <button id="slide2BtnTidakSama" class="w-full bg-gradient-to-r from-red-500 via-pink-500 to-rose-500 hover:from-red-600 hover:via-pink-600 hover:to-rose-600 text-white px-6 py-4 rounded-xl font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg border-2 border-red-400 hover:shadow-xl" onclick="answerSlide2('tidak sama')">
                                        <div class="flex items-center justify-center space-x-3">
                                            <span class="text-2xl">‚ùå</span>
                                            <span>Tidak Sama</span>
                                            <span class="text-2xl animate-bounce">ü§î</span>
                                        </div>
                                    </button>
                                </div>
                                <div id="slide2-feedback" class="hidden mt-6 p-4 rounded-lg">
                                    <!-- Feedback will appear here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 3 -->
                <div id="slide3" class="slide-content hidden">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Menganalisis Sudut dan Sisi</h3>
                    </div>
                    <div class="flex flex-col lg:flex-row items-center gap-6">
                        <div class="w-full lg:w-1/2">
                            <div class="bg-white p-4 rounded-xl shadow-lg">
                                <img src="https://i.imgur.com/WjaUhR6.png" alt="Analisis Sudut dan Sisi" class="w-full h-auto max-h-64 object-contain rounded-lg mb-4" onerror="this.src=''; this.alt='Analisis Sudut dan Sisi'; this.style.display='none';">
                            </div>
                        </div>
                        <div class="w-full lg:w-1/2 text-center lg:text-left">
                            <div class="bg-gradient-to-r from-yellow-100 to-orange-100 p-6 rounded-xl">
                                <h4 class="text-xl md:text-2xl font-bold text-gray-800 mb-4">ü§î Pertanyaan:</h4>
                                <div class="space-y-3 mb-4">
                                    <p class="text-lg md:text-xl text-gray-700 font-semibold leading-relaxed">
                                        ‚Ä¢ Apakah sudut-sudut yang bersesuaian pada kedua segitiga sama besar?
                                    </p>
                                    <p class="text-lg md:text-xl text-gray-700 font-semibold leading-relaxed">
                                        ‚Ä¢ Apakah sisi-sisi yang bersesuaian memiliki perbandingan yang sama?
                                    </p>
                                </div>
                                <div id="slide3-buttons" class="space-y-4">
                                    <button id="slide3BtnSama" class="w-full bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 hover:from-blue-600 hover:via-indigo-600 hover:to-purple-600 text-white px-6 py-4 rounded-xl font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg border-2 border-blue-400 hover:shadow-xl" onclick="answerSlide3('sama')">
                                        <div class="flex items-center justify-center space-x-3">
                                            <span class="text-2xl">‚úÖ</span>
                                            <span>Sama</span>
                                            <span class="text-2xl animate-bounce">üìê</span>
                                        </div>
                                    </button>
                                    <button id="slide3BtnTidakSama" class="w-full bg-gradient-to-r from-orange-500 via-red-500 to-pink-500 hover:from-orange-600 hover:via-red-600 hover:to-pink-600 text-white px-6 py-4 rounded-xl font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg border-2 border-orange-400 hover:shadow-xl" onclick="answerSlide3('tidak sama')">
                                        <div class="flex items-center justify-center space-x-3">
                                            <span class="text-2xl">‚ùå</span>
                                            <span>Tidak Sama</span>
                                            <span class="text-2xl animate-bounce">ü§∑</span>
                                        </div>
                                    </button>
                                </div>
                                <div id="slide3-feedback" class="hidden mt-6 p-4 rounded-lg">
                                    <!-- Feedback will appear here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="slide3-explanation" class="hidden mt-6">
                        <div class="bg-white p-4 rounded-xl shadow-lg">
                            <img src="https://i.imgur.com/x1f1LQy.png" alt="Penjelasan Kesebangunan" class="w-full h-auto max-h-64 object-contain rounded-lg" onerror="this.src=''; this.alt='Penjelasan Kesebangunan'; this.style.display='none';">
                        </div>
                    </div>
                </div>

                <!-- Slide 4 -->
                <div id="slide4" class="slide-content hidden">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Menemukan Hubungan</h3>
                    </div>
                    <div class="flex flex-col lg:flex-row items-center gap-6">
                        <div class="w-full lg:w-1/2">
                            <div class="bg-white p-4 rounded-xl shadow-lg">
                                <img src="https://i.imgur.com/l5Ts113.png" alt="Hubungan Segitiga" class="w-full h-auto max-h-64 object-contain rounded-lg mb-4" onerror="this.src=''; this.alt='Hubungan Segitiga'; this.style.display='none';">
                            </div>
                        </div>
                        <div class="w-full lg:w-1/2 text-center lg:text-left">
                            <div class="bg-gradient-to-r from-pink-100 to-red-100 p-6 rounded-xl">
                                <h4 class="text-xl md:text-2xl font-bold text-gray-800 mb-4">ü§î Pertanyaan:</h4>
                                <p class="text-lg md:text-xl text-gray-700 font-semibold leading-relaxed mb-4">
                                    Menurutmu, apa hubungan antara segitiga putih dan segitiga merah?
                                </p>
                                <textarea id="slide4Answer" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none" rows="4" placeholder="Tuliskan pendapat Anda di sini..." oninput="checkSlide4Answer()"></textarea>
                                <div id="slide4Feedback" class="mt-4 p-4 rounded-lg hidden">
                                    <p class="text-green-600 font-semibold">‚úÖ Terima kasih atas jawaban Anda! Sekarang Anda bisa melanjutkan ke slide berikutnya.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 5 -->
                <div id="slide5" class="slide-content hidden">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Konsep Kesebangunan</h3>
                    </div>
                    <div class="space-y-6">
                        <div class="text-center mb-6">
                            <div class="bg-white p-4 rounded-xl shadow-lg">
                                <img src="https://i.imgur.com/l5Ts113.png" alt="Hubungan Segitiga" class="w-full h-auto max-h-64 object-contain rounded-lg mb-4 mx-auto" onerror="this.src=''; this.alt='Hubungan Segitiga'; this.style.display='none';">
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-indigo-100 to-purple-100 p-6 rounded-xl">
                            <p class="text-lg text-gray-700 mb-4 leading-relaxed">
                                Segitiga putih dan segitiga merah merupakan dua segitiga yang sebangun.
                            </p>
                            <p class="text-lg text-gray-700 mb-4 leading-relaxed">
                                Kesebangunan adalah hubungan dua bangun yang memiliki bentuk sama tetapi ukuran belum tentu sama. Dua bangun dikatakan sebangun jika:
                            </p>
                            <div class="bg-white p-4 rounded-lg">
                                <ul class="text-left space-y-2 text-gray-700">
                                    <li class="flex items-start"><span class="text-blue-500 mr-2">‚Ä¢</span> Bentuknya sama (sudut-sudut yang bersesuaian sama besar).</li>
                                    <li class="flex items-start"><span class="text-blue-500 mr-2">‚Ä¢</span> Perbandingan panjang sisi-sisi yang bersesuaian sama.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="text-center mb-6">
                            <div class="bg-white p-4 rounded-xl shadow-lg">
                                <img src="https://i.imgur.com/0BBJVdf.png" alt="Ilustrasi Kesebangunan" class="w-full h-auto max-h-64 object-contain rounded-lg mb-4 mx-auto" onerror="this.src=''; this.alt='Ilustrasi Kesebangunan'; this.style.display='none';">
                                <p class="text-xl font-semibold text-gray-800">Ilustrasi Kesebangunan</p>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-orange-100 to-red-100 p-6 rounded-xl mb-6">
                            <h4 class="text-xl md:text-2xl font-bold text-gray-800 mb-4 text-center">Rumus perbandingan sisi:</h4>
                            <div class="text-center">
                                <div class="bg-white p-4 rounded-xl shadow-lg">
                                    <img src="https://i.imgur.com/65FKX3K.png" alt="Rumus Perbandingan Sisi" class="w-full h-auto max-h-32 object-contain rounded-lg mx-auto" onerror="this.src=''; this.alt='Rumus Perbandingan Sisi'; this.style.display='none';">
                                </div>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-yellow-100 to-orange-100 p-6 rounded-xl text-center">
                            <h4 class="text-xl font-bold text-gray-800 mb-2">Simbol kesebangunan:</h4>
                            <div class="text-center mb-4">
                                <p class="text-2xl font-bold text-gray-800">‚àÜABC ~ ‚àÜDEF</p>
                            </div>
                            <p class="text-lg text-gray-700 mt-2">yang artinya segitiga ABC sebangun dengan segitiga DEF.</p>
                        </div>
                    </div>
                </div>

                <!-- Slide 6 -->
                <div id="slide6" class="slide-content hidden">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Contoh Soal</h3>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-gradient-to-r from-blue-100 to-indigo-100 p-6 rounded-xl">
                            <h4 class="text-xl md:text-2xl font-bold text-gray-800 mb-4">üìù Contoh Soal:</h4>
                            <div class="text-center mb-4">
                                <div class="bg-white p-4 rounded-xl shadow-lg">
                                    <img src="https://i.imgur.com/3hiKbI9.png" alt="Contoh Soal Kesebangunan" class="w-full h-auto max-h-48 object-contain rounded-lg mb-4 mx-auto" onerror="this.src=''; this.alt='Contoh Soal Kesebangunan'; this.style.display='none';">
                                </div>
                            </div>
                            <p class="text-lg text-gray-700 leading-relaxed text-center">
                                Jika panjang alas segitiga putih adalah <strong>8 m</strong>, dan panjang alas segitiga merah adalah <strong>4 m</strong>, serta tinggi segitiga merah adalah <strong>3 m</strong>, berapakah tinggi segitiga putih?
                            </p>
                        </div>
                        <div class="bg-gradient-to-r from-green-100 to-teal-100 p-6 rounded-xl">
                            <h4 class="text-xl md:text-2xl font-bold text-gray-800 mb-4">‚úÖ Jawaban:</h4>
                            <div class="space-y-4">
                                <div class="bg-white p-4 rounded-lg">
                                    <h5 class="text-lg font-bold text-gray-800 mb-2">Langkah Pertama (Memahami masalah)</h5>
                                    <p class="text-gray-700 mb-2"><strong>Diketahui:</strong></p>
                                    <ul class="text-gray-700 ml-4 space-y-1">
                                        <li>‚Ä¢ Segitiga putih sebangun dengan segitiga merah</li>
                                        <li>‚Ä¢ Panjang alas segitiga putih = 8 m</li>
                                        <li>‚Ä¢ Panjang alas segitiga merah = 4 m</li>
                                        <li>‚Ä¢ Tinggi segitiga merah = 3 m</li>
                                    </ul>
                                    <p class="text-gray-700 mt-2"><strong>Ditanyakan:</strong></p>
                                    <p class="text-gray-700 ml-4">Berapa tinggi segitiga putih?</p>
                                </div>
                                <div class="bg-white p-4 rounded-lg">
                                    <h5 class="text-lg font-bold text-gray-800 mb-2">Langkah Kedua (Merencanakan masalah)</h5>
                                    <p class="text-gray-700 mb-2">Karena kedua segitiga sebangun, perbandingan sisi-sisi yang bersesuaian adalah sama. Tuliskan perbandingan sisi yang bersesuaian.</p>
                                    <div class="text-center my-4">
                                        <div class="bg-white p-4 rounded-xl shadow-lg mb-6">
                                            <img src="https://i.imgur.com/ASCSdxT.png" alt="Perbandingan Sisi" class="w-full h-auto max-h-24 object-contain rounded-lg mx-auto" onerror="this.src=''; this.alt='Perbandingan Sisi'; this.style.display='none';">
                                        </div>
                                        <div class="bg-white p-4 rounded-xl shadow-lg">
                                            <img src="https://i.imgur.com/jIB1g1q.png" alt="Substitusi Nilai" class="w-full h-auto max-h-24 object-contain rounded-lg mx-auto" onerror="this.src=''; this.alt='Substitusi Nilai'; this.style.display='none';">
                                        </div>
                                    </div>
                                    <p class="text-gray-700">Kemudian mencari nilai tinggi ‚ñ≥putih (menggunakan perkalian silang).</p>
                                </div>
                                <div class="bg-white p-4 rounded-lg">
                                    <h5 class="text-lg font-bold text-gray-800 mb-2">Langkah Ketiga (Menjalankan rencana)</h5>
                                    <p class="text-gray-700 mb-2">Menentukan nilai tinggi ‚ñ≥putih</p>
                                    <div class="text-center">
                                        <div class="bg-white p-4 rounded-xl shadow-lg">
                                            <img src="https://i.imgur.com/oF3A155.png" alt="Penyelesaian" class="w-full h-auto max-h-32 object-contain rounded-lg mx-auto" onerror="this.src=''; this.alt='Penyelesaian'; this.style.display='none';">
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-white p-4 rounded-lg">
                                    <h5 class="text-lg font-bold text-gray-800 mb-2">Langkah Keempat (Memeriksa kebenaran)</h5>
                                    <p class="text-gray-700 mb-2">Dengan menggunakan perbandingan sisi pada bangun yang sebangun, maka diperoleh tinggi segitiga putih yaitu 6 m.</p>
                                    <p class="text-gray-700 mb-2">Perbandingan sisi-sisi yang bersesuaian sama:</p>
                                    <div class="text-center mb-2">
                                        <div class="bg-white p-4 rounded-xl shadow-lg">
                                            <img src="https://i.imgur.com/oQ20VAh.png" alt="Pemeriksaan Kebenaran" class="w-full h-auto max-h-16 object-contain rounded-lg mx-auto" onerror="this.src=''; this.alt='Pemeriksaan Kebenaran'; this.style.display='none';">
                                        </div>
                                    </div>
                                    <p class="text-gray-700">Karena semua perbandingan sisi yang bersesuaian sama, maka benar segitiga putih dan segitiga merah sebangun dan tinggi segitiga putih adalah 6 m.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide Indicators -->
            <div class="flex justify-center space-x-2 mt-6">
                <button class="slide-indicator w-3 h-3 rounded-full bg-blue-500" onclick="playSound('click'); showSlide(1)"></button>
                <button class="slide-indicator w-3 h-3 rounded-full bg-gray-300" onclick="playSound('click'); showSlide(2)"></button>
                <button class="slide-indicator w-3 h-3 rounded-full bg-gray-300" onclick="playSound('click'); showSlide(3)"></button>
                <button class="slide-indicator w-3 h-3 rounded-full bg-gray-300" onclick="playSound('click'); showSlide(4)"></button>
                <button class="slide-indicator w-3 h-3 rounded-full bg-gray-300" onclick="playSound('click'); showSlide(5)"></button>
                <button class="slide-indicator w-3 h-3 rounded-full bg-gray-300" onclick="playSound('click'); showSlide(6)"></button>
            </div>

            <!-- Navigation Controls -->
            <div class="flex justify-between items-center mt-8 pt-6 border-t-2 border-gray-200">
                <button class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-6 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); previousSlide()">
                    ‚¨ÖÔ∏è Sebelumnya
                </button>
                <div class="text-center bg-gradient-to-r from-indigo-100 to-purple-100 px-6 py-3 rounded-full border-2 border-indigo-300">
                    <div class="text-lg font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600">
                        Slide <span id="currentSlideNumber">1</span> dari 6
                    </div>
                </div>
                <button class="neon-button text-black px-6 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); nextSlide()">
                    Selanjutnya ‚û°Ô∏è
                </button>
            </div>

            <!-- Back to Home Button -->
            <div class="text-center mt-8 pt-6 border-t-2 border-gray-200">
                <button class="neon-button px-8 py-4 rounded-full text-lg font-bold" onclick="playSound('click'); showPage('homePage')">
                    üè† Kembali ke Beranda
                </button>
            </div>
        </div>
    </div>

    <!-- Halaman Input Nama -->
    <div id="nameInputPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="glass-card rounded-3xl p-8 max-w-md mx-auto w-full holographic">
            <div class="text-center mb-8">
                <div class="relative mb-6">
                    <div class="absolute -inset-4 bg-gradient-to-r from-pink-400 via-purple-500 to-indigo-500 rounded-3xl blur-xl opacity-30 animate-pulse"></div>
                    <div class="relative">
                        <h2 class="text-3xl md:text-4xl font-bold mb-4 game-title">üìù Masukkan Nama</h2>
                        <div class="text-4xl md:text-6xl mb-4 floating">üë§</div>
                        <p class="text-lg md:text-xl text-white neon-text">Siapa nama kamu?</p>
                    </div>
                </div>
            </div>

            <div class="bg-gradient-to-br from-white via-blue-50 to-purple-50 rounded-3xl p-6 shadow-2xl border-2 border-white/50">
                <div class="mb-6">
                    <label for="playerName" class="block text-lg font-bold text-gray-800 mb-3 text-center">
                        üåü Nama Lengkap Kamu:
                    </label>
                    <input 
                        type="text" 
                        id="playerName" 
                        class="w-full px-6 py-4 text-lg border-3 border-gray-300 rounded-2xl focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-200 transition-all duration-300 text-center font-semibold bg-white shadow-lg"
                        placeholder="Masukkan nama kamu"
                        maxlength="50"
                        onkeypress="if(event.key==='Enter') startQuizWithName()"
                        oninput="checkNameInput()"
                    >
                    <div id="nameError" class="hidden mt-3 p-3 bg-red-100 border-l-4 border-red-500 rounded-lg">
                        <p class="text-red-700 font-semibold text-center">
                            ‚ö†Ô∏è Nama harus diisi minimal 2 karakter!
                        </p>
                    </div>
                </div>

                <div class="space-y-4">
                    <button 
                        id="startQuizBtn" 
                        class="w-full neon-button text-black px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg" 
                        onclick="playSound('click'); startQuizWithName()"
                        disabled
                    >
                        üöÄ Mulai Latihan Soal
                    </button>
                    <button 
                        class="w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg" 
                        onclick="playSound('click'); showPage('homePage')"
                    >
                        ‚¨ÖÔ∏è Kembali ke Beranda
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Halaman Quiz -->
    <div id="quizPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="glass-card rounded-3xl p-6 max-w-6xl mx-auto w-full holographic">
            <!-- Quiz Header -->
            <div class="text-center mb-6">
                <div class="relative mb-6">
                    <div class="absolute -inset-4 bg-gradient-to-r from-pink-400 via-purple-500 to-indigo-500 rounded-3xl blur-xl opacity-30 animate-pulse"></div>
                    <div class="relative">
                        <h2 class="text-3xl md:text-4xl font-bold mb-4 game-title">üöÄ Latihan Soal üéÆ</h2>
                        <div class="text-4xl md:text-6xl mb-4 floating">üìù</div>
                        <p class="text-lg md:text-xl text-white neon-text">Uji Pemahaman Kesebangunan</p>
                    </div>
                </div>
                <!-- Player Name Display -->
                <div class="text-center mb-4">
                    <div class="bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 p-1 rounded-2xl shadow-2xl inline-block">
                        <div class="bg-white/95 px-6 py-3 rounded-xl">
                            <div class="text-lg md:text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-600 to-red-600">
                                üëã Hai <span id="playerNameDisplay" class="text-orange-600">Peserta</span>!
                            </div>
                            <div class="text-sm text-gray-600 font-semibold">Selamat mengerjakan quiz</div>
                        </div>
                    </div>
                </div>
                <!-- Quiz Stats -->
                <div class="flex justify-center space-x-8 mt-6 mb-4">
                    <div class="text-center">
                        <div class="text-xl md:text-2xl font-bold text-white mb-2">‚úÖ <span id="quizCorrectCount" class="text-green-400">0</span></div>
                        <div class="text-sm text-white font-semibold">Skor</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xl md:text-2xl font-bold text-white mb-2">‚è∞ <span id="quizTimer" class="text-blue-400">25:00</span></div>
                        <div class="text-sm text-white font-semibold">Waktu</div>
                    </div>
                </div>
            </div>

            <!-- Quiz Content -->
            <div class="bg-gradient-to-br from-white via-blue-50 to-purple-50 rounded-3xl p-4 md:p-8 shadow-2xl min-h-[600px] border-2 border-white/50">
                <!-- Question Header -->
                <div class="text-center mb-6">
                    <div class="bg-gradient-to-r from-orange-400 via-pink-500 to-purple-600 p-1 rounded-2xl mb-4 inline-block">
                        <div class="bg-white px-6 py-3 rounded-xl">
                            <h3 id="quizQuestionTitle" class="text-2xl md:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-purple-600 mb-2">Pertanyaan 1</h3>
                            <p id="quizQuestionDescription" class="text-lg md:text-xl text-gray-700 font-semibold mb-0">Perhatikan gambar kain corak insang diatas!</p>
                        </div>
                    </div>
                </div>

                <!-- Question Image -->
                <div class="text-center mb-6">
                    <div class="bg-gradient-to-br from-yellow-400 via-orange-500 to-red-500 p-1 rounded-2xl shadow-2xl transform hover:scale-105 transition-all duration-300 inline-block">
                        <div id="quizImageContainer" class="bg-white p-6 rounded-xl">
                            <div class="text-6xl mb-4">üìê</div>
                            <p class="text-lg font-semibold text-gray-800">Gambar Soal</p>
                        </div>
                    </div>
                </div>

                <!-- Question Context -->
                <div class="bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400 p-1 rounded-2xl mb-6 shadow-lg">
                    <div class="bg-gradient-to-r from-yellow-50 via-orange-50 to-red-50 p-6 rounded-xl">
                        <div class="flex items-center justify-center mb-3">
                            <div class="text-3xl mr-3">üìã</div>
                            <h4 class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-600 to-red-600">Informasi Soal</h4>
                        </div>
                        <p id="quizQuestionContext" class="text-gray-700 leading-relaxed text-center font-medium">
                        </p>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-blue-400 via-indigo-500 to-purple-500 p-1 rounded-2xl mb-6 shadow-lg">
                    <div class="bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 p-6 rounded-xl">
                        <div class="flex items-center justify-center mb-3">
                            <div class="text-3xl mr-3">‚ùì</div>
                            <h4 class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600">Pertanyaan</h4>
                        </div>
                        <h4 id="quizSubQuestion" class="text-xl md:text-2xl font-bold text-gray-800 text-center mb-4">
                            <!-- Sub question will be inserted here -->
                        </h4>
                        <div id="quizQuestionImageContainer" class="text-center hidden">
                        </div>
                    </div>
                </div>

                <!-- Answer Options -->
                <div class="bg-gradient-to-r from-green-400 via-teal-500 to-cyan-500 p-1 rounded-2xl mb-8 shadow-lg">
                    <div class="bg-gradient-to-r from-green-50 via-teal-50 to-cyan-50 p-6 rounded-xl">
                        <div class="flex items-center justify-center mb-4">
                            <div class="text-3xl mr-3">üéØ</div>
                            <h4 class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-cyan-600">Pilihan Jawaban</h4>
                        </div>
                        <!-- Auto advance countdown -->
                        <div id="autoAdvanceCountdown" class="hidden text-center mb-4">
                            <div class="bg-gradient-to-r from-orange-100 to-red-100 p-4 rounded-xl border-2 border-orange-300">
                                <div class="text-lg font-bold text-orange-800 mb-2">
                                    ‚è∞ Otomatis lanjut dalam <span id="countdownTimer" class="text-red-600">10</span> detik
                                </div>
                                <div class="text-sm text-orange-700">Klik "Selanjutnya" untuk lanjut sekarang</div>
                            </div>
                        </div>
                        <div id="quizOptions" class="space-y-4">
                            <!-- Options will be generated here -->
                        </div>
                    </div>
                </div>

                <!-- Navigation Controls -->
                <div class="flex justify-between items-center pt-6 border-t-4 border-gradient-to-r from-pink-300 via-purple-300 to-indigo-300">
                    <button id="quizPrevBtn" class="bg-gradient-to-r from-gray-500 via-gray-600 to-gray-700 hover:from-gray-600 hover:via-gray-700 hover:to-gray-800 text-white px-6 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg border-2 border-gray-400" onclick="playSound('click'); previousQuizQuestion()">
                        ‚¨ÖÔ∏è Sebelumnya
                    </button>
                    
                    <div class="text-center bg-gradient-to-r from-indigo-100 to-purple-100 px-6 py-3 rounded-full border-2 border-indigo-300">
                        <div class="text-lg font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600">
                            Soal <span id="quizProgress2" class="text-purple-700">1</span> dari <span class="text-indigo-700">12</span>
                        </div>
                    </div>
                    
                    <button id="quizNextBtn" class="neon-button text-black px-6 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg" onclick="playSound('click'); nextQuizQuestion()" disabled>
                        Selanjutnya ‚û°Ô∏è
                    </button>
                </div>
            </div>

            <!-- Back to Home Button -->
            <div class="text-center mt-8 pt-6 border-t-4 border-gradient-to-r from-pink-300 via-purple-300 to-indigo-300">
                <button class="bg-gradient-to-r from-red-500 via-pink-500 to-purple-500 hover:from-red-600 hover:via-pink-600 hover:to-purple-600 text-white px-8 py-4 rounded-full text-lg font-bold transition-all duration-300 transform hover:scale-105 shadow-2xl border-2 border-red-400" onclick="playSound('click'); confirmExitQuiz()">
                    üè† Keluar Quiz
                </button>
            </div>
        </div>
    </div>

    <!-- Halaman Hasil Quiz -->
    <div id="quizResultPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="glass-card rounded-3xl p-8 max-w-2xl mx-auto w-full holographic">
            <div class="text-center mb-8">
                <div class="relative mb-6">
                    <div class="absolute -inset-4 bg-gradient-to-r from-green-400 via-blue-500 to-purple-500 rounded-3xl blur-xl opacity-30 animate-pulse"></div>
                    <div class="relative">
                        <h2 class="text-3xl md:text-4xl font-bold mb-4 game-title">üéâ Hasil Quiz üèÜ</h2>
                        <div id="resultEmoji" class="text-6xl md:text-8xl mb-4 floating">üéä</div>
                        <p class="text-lg md:text-xl text-white neon-text">Selamat telah menyelesaikan quiz!</p>
                    </div>
                </div>
            </div>

            <div class="bg-gradient-to-br from-white via-blue-50 to-purple-50 rounded-3xl p-6 shadow-2xl border-2 border-white/50">
                <div id="quizResultContent" class="text-center">
                    <!-- Results will be shown here -->
                </div>

                <div class="space-y-4 mt-8">
                    <button 
                        class="w-full neon-button text-black px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg" 
                        onclick="playSound('click'); startQuiz()"
                    >
                        üîÑ Coba Lagi
                    </button>
                    <button 
                        class="w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg" 
                        onclick="playSound('click'); showPage('homePage')"
                    >
                        üè† Kembali ke Beranda
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Halaman Memory Game -->
    <div id="memoryGamePage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="glass-card rounded-3xl p-6 max-w-6xl mx-auto w-full">
            <!-- Memory Game Header -->
            <div class="text-center mb-6">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 game-title">üéÆ Cocokin Yuk! üß©</h2>
                <div class="text-4xl md:text-6xl mb-4 floating">ü•Å</div>
                <p class="text-lg md:text-xl text-white neon-text">Game Memori Rebana Melayu</p>
                
                <!-- Game Stats -->
                <div class="flex justify-center space-x-8 mt-6 mb-4">
                    <div class="bg-gradient-to-r from-blue-100 to-purple-100 px-6 py-3 rounded-xl">
                        <div class="text-2xl font-bold text-gray-800">‚è∞ <span id="memoryGameTimer" class="text-blue-600">0:00</span></div>
                        <div class="text-sm text-gray-600">Waktu</div>
                    </div>
                    <div class="bg-gradient-to-r from-green-100 to-teal-100 px-6 py-3 rounded-xl">
                        <div class="text-2xl font-bold text-gray-800">üéØ <span id="memoryGameMatches" class="text-green-600">0</span>/6</div>
                        <div class="text-sm text-gray-600">Pasangan</div>
                    </div>
                </div>
                <!-- Instructions -->
                <div class="bg-gradient-to-r from-yellow-100 to-orange-100 p-4 rounded-xl mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">üìã Cara Bermain:</h3>
                    <p class="text-gray-700">Klik kartu untuk membaliknya dan temukan pasangan gambar rebana yang sebangun!</p>
                </div>
            </div>

            <!-- Memory Game Board -->
            <div class="bg-white/95 rounded-2xl p-4 md:p-6 shadow-2xl">
                <div id="memoryGameBoard" class="memory-game-board">
                    <!-- Cards will be generated here -->
                </div>
            </div>

            <!-- Control Buttons -->
            <div class="flex justify-center space-x-4 mt-6">
                <button class="bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white px-6 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); resetMemoryGame()">
                    üîÑ Reset Game
                </button>
                <button class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-6 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); showPage('homePage')">
                    üè† Kembali ke Beranda
                </button>
            </div>
        </div>
    </div>

    <!-- Quiz Results Modal -->
    <div id="quizResultsModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="glass-card rounded-3xl p-8 max-w-lg mx-4 shadow-2xl bounce-in-3d glow-effect">
            <div class="text-center">
                <div id="quizResultEmoji" class="text-8xl mb-4">üéâ</div>
                <h3 id="quizResultTitle" class="text-3xl font-bold text-gray-800 mb-4">Selamat!</h3>
                <div class="bg-gradient-to-r from-blue-100 to-purple-100 p-6 rounded-xl mb-6">
                    <div class="text-center mb-4">
                        <div class="text-4xl font-bold text-gray-800 mb-2">
                            <span id="quizFinalScore" class="text-blue-600">0</span>/<span id="quizTotalQuestions" class="text-gray-600">12</span>
                        </div>
                        <div class="text-lg text-gray-600 mb-4">Jawaban Benar</div>
                    </div>
                    <div class="text-center mb-4">
                        <div class="text-2xl font-bold text-gray-800">
                            ‚è∞ Waktu: <span id="quizFinalTime" class="text-purple-600">0:00</span>
                        </div>
                    </div>
                    <p id="quizScoreMessage" class="text-lg text-gray-700 font-semibold text-center">
                        Hebat sekali!
                    </p>
                </div>
                <div class="space-y-4">
                    <button class="w-full neon-button text-black px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); restartQuiz()">
                        üîÑ Coba Lagi
                    </button>
                    <button class="w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); closeQuizResults(); showPage('homePage')">
                        üè† Kembali ke Beranda
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Memory Game Results Modal -->
    <div id="memoryGameResultsModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="glass-card rounded-3xl p-8 max-w-lg mx-4 shadow-2xl bounce-in-3d glow-effect">
            <div class="text-center">
                <div id="memoryResultEmoji" class="text-8xl mb-4">üéâ</div>
                <h3 class="text-3xl font-bold text-gray-800 mb-4">Selamat!</h3>
                <div class="bg-gradient-to-r from-blue-100 to-purple-100 p-6 rounded-xl mb-6">
                    <p class="text-xl text-gray-700 font-semibold mb-2">
                        Kamu berhasil mencocokkan semua pasangan rebana!
                    </p>
                    <p class="text-2xl font-bold text-gray-800 mb-2">
                        ‚è∞ Waktu: <span id="memoryFinalTime" class="text-blue-600">0:00</span>
                    </p>
                    <p id="memoryScoreMessage" class="text-lg text-gray-700 font-semibold">
                        Hebat sekali!
                    </p>
                </div>
                <div class="space-y-4">
                    <button class="w-full neon-button text-black px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); restartMemoryGame()">
                        üîÑ Main Lagi
                    </button>
                    <button class="w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); closeMemoryGameResults(); showPage('homePage')">
                        üè† Kembali ke Beranda
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz Exit Confirmation Modal -->
    <div id="quizExitModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="glass-card rounded-3xl p-8 max-w-md mx-4 shadow-2xl bounce-in-3d glow-effect">
            <div class="text-center">
                <div class="text-8xl mb-4">‚ö†Ô∏è</div>
                <h3 class="text-3xl font-bold text-gray-800 mb-4">Keluar Quiz?</h3>
                <div class="bg-gradient-to-r from-yellow-100 to-orange-100 p-6 rounded-xl mb-6">
                    <p class="text-xl text-gray-700 font-semibold mb-2">
                        Apakah kamu yakin ingin keluar?
                    </p>
                    <p class="text-lg text-gray-600">
                        Progres quiz akan hilang dan tidak tersimpan.
                    </p>
                </div>
                <div class="space-y-4">
                    <button class="w-full bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); exitQuiz()">
                        ‚úÖ Ya, Keluar
                    </button>
                    <button class="w-full neon-button text-black px-8 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); closeExitQuiz()">
                        ‚ùå Batal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Halaman Dashboard Host -->
    <div id="hostDashboardPage" class="hidden min-h-screen p-4">
        <div class="max-w-7xl mx-auto">
            <!-- Dashboard Header -->
            <div class="glass-card rounded-3xl p-6 mb-6 holographic">
                <div class="text-center mb-6">
                    <h1 class="text-3xl md:text-4xl font-bold mb-4 game-title">üë®‚Äçüè´ Dashboard Host</h1>
                    <div class="text-4xl md:text-6xl mb-4 floating">üìä</div>
                    <p class="text-lg md:text-xl text-white neon-text">Monitoring Real-time User Activity</p>
                </div>
                
                <!-- Dashboard Tabs -->
                <div class="flex flex-wrap justify-center space-x-2 mb-6">
                    <button class="dashboard-tab active bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-6 py-3 rounded-full font-bold transition-all duration-300" onclick="showDashboardTab('overview')">
                        üìà Overview
                    </button>
                    <button class="dashboard-tab bg-gradient-to-r from-gray-400 to-gray-500 text-white px-6 py-3 rounded-full font-bold transition-all duration-300" onclick="showDashboardTab('users')">
                        üë• Users
                    </button>
                    <button class="dashboard-tab bg-gradient-to-r from-gray-400 to-gray-500 text-white px-6 py-3 rounded-full font-bold transition-all duration-300" onclick="showDashboardTab('quiz')">
                        üéØ Quiz Results
                    </button>
                    <button class="dashboard-tab bg-gradient-to-r from-gray-400 to-gray-500 text-white px-6 py-3 rounded-full font-bold transition-all duration-300" onclick="showDashboardTab('game')">
                        üéÆ Game Results
                    </button>
                </div>
                
                <!-- Back Button -->
                <div class="text-center">
                    <button class="bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white px-6 py-3 rounded-full font-bold transition-all duration-300 transform hover:scale-105" onclick="playSound('click'); showPage('homePage')">
                        üè† Kembali ke Beranda
                    </button>
                </div>
            </div>
            
            <!-- Dashboard Content -->
            <div id="dashboardContent" class="dashboard-content">
                <!-- Overview Tab -->
                <div id="overviewTab" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="glass-card rounded-2xl p-6 text-center">
                        <div class="text-4xl mb-3">üë•</div>
                        <div class="text-2xl font-bold text-white mb-2" id="totalUsers">0</div>
                        <div class="text-sm text-gray-300">Total Users</div>
                    </div>
                    <div class="glass-card rounded-2xl p-6 text-center">
                        <div class="text-4xl mb-3">üéØ</div>
                        <div class="text-2xl font-bold text-white mb-2" id="totalQuizzes">0</div>
                        <div class="text-sm text-gray-300">Quiz Completed</div>
                    </div>
                    <div class="glass-card rounded-2xl p-6 text-center">
                        <div class="text-4xl mb-3">üéÆ</div>
                        <div class="text-2xl font-bold text-white mb-2" id="totalGames">0</div>
                        <div class="text-sm text-gray-300">Games Played</div>
                    </div>
                    <div class="glass-card rounded-2xl p-6 text-center">
                        <div class="text-4xl mb-3">üìñ</div>
                        <div class="text-2xl font-bold text-white mb-2" id="totalMaterials">0</div>
                        <div class="text-sm text-gray-300">Material Views</div>
                    </div>
                </div>
                
                <!-- Users Tab -->
                <div id="usersTab" class="hidden">
                    <div class="glass-card rounded-2xl p-6">
                        <h3 class="text-2xl font-bold text-white mb-4">üë• Active Users</h3>
                        <div class="bg-white/10 rounded-xl p-4">
                            <div class="text-center text-gray-300">
                                <div class="text-6xl mb-4">üìä</div>
                                <p class="text-lg">Data pengguna akan muncul di sini secara real-time</p>
                                <p class="text-sm mt-2">Termasuk nama, device, waktu akses, dan aktivitas</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Results Tab -->
                <div id="quizTab" class="hidden">
                    <div class="glass-card rounded-2xl p-6">
                        <h3 class="text-2xl font-bold text-white mb-4">üéØ Quiz Performance</h3>
                        <div class="bg-white/10 rounded-xl p-4">
                            <div class="text-center text-gray-300">
                                <div class="text-6xl mb-4">üìà</div>
                                <p class="text-lg">Hasil quiz dan statistik akan ditampilkan di sini</p>
                                <p class="text-sm mt-2">Skor, waktu penyelesaian, dan analisis jawaban</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Game Results Tab -->
                <div id="gameTab" class="hidden">
                    <div class="glass-card rounded-2xl p-6">
                        <h3 class="text-2xl font-bold text-white mb-4">üéÆ Game Statistics</h3>
                        <div class="bg-white/10 rounded-xl p-4">
                            <div class="text-center text-gray-300">
                                <div class="text-6xl mb-4">üèÜ</div>
                                <p class="text-lg">Statistik game memory akan ditampilkan di sini</p>
                                <p class="text-sm mt-2">Waktu penyelesaian, jumlah percobaan, dan performa</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Halaman Host Login -->
    <div id="hostLoginPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="glass-card rounded-3xl p-8 max-w-md mx-auto w-full holographic">
            <div class="text-center mb-8">
                <div class="relative mb-6">
                    <div class="absolute -inset-4 bg-gradient-to-r from-indigo-400 via-blue-500 to-cyan-500 rounded-3xl blur-xl opacity-30 animate-pulse"></div>
                    <div class="relative">
                        <h2 class="text-3xl md:text-4xl font-bold mb-4 game-title">üë®‚Äçüè´ Login Host</h2>
                        <div class="text-4xl md:text-6xl mb-4 floating">üîê</div>
                        <p class="text-lg md:text-xl text-white neon-text">Akses Dashboard Host</p>
                    </div>
                </div>
            </div>

            <div class="bg-gradient-to-br from-white via-blue-50 to-cyan-50 rounded-3xl p-6 shadow-2xl border-2 border-white/50">
                <div class="mb-6">
                    <label for="hostPassword" class="block text-lg font-bold text-gray-800 mb-3 text-center">
                        üîë Password Host:
                    </label>
                    <input 
                        type="password" 
                        id="hostPassword" 
                        class="w-full px-6 py-4 text-lg border-3 border-gray-300 rounded-2xl focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-200 transition-all duration-300 text-center font-semibold bg-white shadow-lg"
                        placeholder="Masukkan password host"
                        onkeypress="if(event.key==='Enter') loginHost()"
                    >
                    <div class="mt-3 p-3 bg-blue-100 border-l-4 border-blue-500 rounded-lg">
                        <p class="text-blue-700 font-semibold text-center text-sm">
                            üí° <strong>Hint:</strong> Password demo adalah <code class="bg-blue-200 px-2 py-1 rounded">host123</code>
                        </p>
                    </div>
                </div>

                <div class="space-y-4">
                    <button 
                        class="w-full neon-button text-black px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg" 
                        onclick="playSound('click'); loginHost()"
                    >
                        üöÄ Masuk Dashboard
                    </button>
                    <button 
                        class="w-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg" 
                        onclick="playSound('click'); showPage('homePage')"
                    >
                        ‚¨ÖÔ∏è Kembali ke Beranda
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Home Page -->
    <div id="homePage" class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-4xl mx-auto text-center w-full">
            <div class="glass-card rounded-3xl p-8 shadow-2xl bounce-in-3d card-hover holographic">
                <div class="mb-8">
                    <div class="text-6xl mb-4 floating">üéÆüåàüìê‚ú®</div>
                    
                    <div class="flex justify-center mb-8">
                        <div class="relative group">
                            <div class="absolute -inset-6 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 rounded-3xl blur-2xl opacity-30 group-hover:opacity-50 transition-all duration-500 animate-pulse"></div>
                            <div class="relative glass-card rounded-3xl p-8 border-2 border-white/20 shadow-2xl glow-effect">
                                <div class="text-center bg-gradient-to-r from-yellow-600 to-orange-600 text-white p-8 rounded-2xl">
                                    <img src="https://i.imgur.com/sWMWajt.png" alt="ETHNOMATH Twin Shapes by Veni Siswiandini" class="w-full h-auto max-h-80 object-contain rounded-lg mx-auto" onerror="this.src=''; this.alt='ETHNOMATH Twin Shapes by Veni Siswiandini'; this.style.display='none';">
                                </div>
                            </div>
                            <!-- Enhanced Floating Elements -->
                            <div class="absolute -top-6 -right-6 text-4xl animate-bounce floating" style="animation-delay: 0s;">‚ú®</div>
                            <div class="absolute -bottom-6 -left-6 text-4xl animate-bounce floating" style="animation-delay: 0.5s;">üåü</div>
                            <div class="absolute top-1/2 -left-8 text-3xl animate-bounce floating" style="animation-delay: 1s;">‚≠ê</div>
                            <div class="absolute top-1/2 -right-8 text-3xl animate-bounce floating" style="animation-delay: 1.5s;">üí´</div>
                            <div class="absolute top-1/4 -left-10 text-2xl animate-bounce floating" style="animation-delay: 2s;">üéØ</div>
                            <div class="absolute top-3/4 -right-10 text-2xl animate-bounce floating" style="animation-delay: 2.5s;">üé®</div>
                        </div>
                    </div>
                    <div class="text-2xl font-bold mb-6 text-center game-title">
                        <div style="font-family: 'Orbitron', monospace; font-weight: 600; font-size: 2.2rem; color: #FFFFFF; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); letter-spacing: 0.3px; margin-bottom: 0.5rem; line-height: 1.3; word-wrap: break-word; overflow-wrap: break-word;">Ethnomathematics Twin Shapes</div>
                        <div style="font-family: 'Orbitron', monospace; font-weight: 600; font-size: 1.2rem; color: #FFFFFF; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); letter-spacing: 0.3px; margin-top: 0.5rem;">by Veni Siswiandini</div>
                    </div>
                    <div class="text-3xl mb-6 floating">üéØüé™üöÄüéä</div>
                </div>

                <!-- Enhanced Feature Cards -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                    <div class="glass-card rounded-2xl p-6 card-hover glow-effect slide-in-left" style="border: 3px solid rgba(59, 130, 246, 0.6); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);">
                        <div class="text-5xl floating mb-3">üé≤</div>
                        <div class="text-xl text-blue-600 font-bold neon-text">Seru &</div>
                        <div class="text-lg text-white font-bold">Menarik!</div>
                    </div>
                    <div class="glass-card rounded-2xl p-6 card-hover glow-effect slide-in-up" style="animation-delay: 0.1s; border: 3px solid rgba(34, 197, 94, 0.6); box-shadow: 0 8px 25px rgba(34, 197, 94, 0.3);">
                        <div class="text-5xl floating mb-3" style="animation-delay: 0.5s;">‚è∞</div>
                        <div class="text-xl text-green-600 font-bold neon-text">Interaktif</div>
                        <div class="text-lg text-white font-bold">Seru!</div>
                    </div>
                    <div class="glass-card rounded-2xl p-6 card-hover glow-effect slide-in-down" style="animation-delay: 0.2s; border: 3px solid rgba(245, 158, 11, 0.6); box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3);">
                        <div class="text-5xl floating mb-3" style="animation-delay: 1s;">üèÜ</div>
                        <div class="text-xl text-yellow-600 font-bold neon-text">Budaya</div>
                        <div class="text-lg text-white font-bold">Melayu</div>
                    </div>
                    <div class="glass-card rounded-2xl p-6 card-hover glow-effect slide-in-right" style="animation-delay: 0.3s; border: 3px solid rgba(168, 85, 247, 0.6); box-shadow: 0 8px 25px rgba(168, 85, 247, 0.3);">
                        <div class="text-5xl floating mb-3" style="animation-delay: 1.5s;">üé®</div>
                        <div class="text-xl text-purple-600 font-bold neon-text">Animasi</div>
                        <div class="text-lg text-white font-bold">Keren!</div>
                    </div>
                </div>

                <!-- Enhanced Action Buttons -->
                <div class="space-y-6">
                    <button class="w-full neon-button text-black px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg" onclick="playSound('click'); showMaterial()">
                        üìñ Materi Pembelajaran üìö
                    </button>
                    <button class="w-full bg-gradient-to-r from-green-500 via-teal-500 to-blue-600 hover:from-green-600 hover:via-teal-600 hover:to-blue-700 text-black px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-2xl border-3 border-green-400" onclick="playSound('click'); showNameInput()" style="background: linear-gradient(135deg, #10B981 0%, #14B8A6 50%, #3B82F6 100%); box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4), inset 0 2px 0 rgba(255, 255, 255, 0.3); text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9), 1px 1px 2px rgba(255, 255, 255, 0.8), 0 0 6px rgba(255, 255, 255, 0.6);">
                        üöÄ Latihan Soal üéÆ
                    </button>
                    <button class="w-full bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-600 hover:from-pink-600 hover:via-purple-600 hover:to-indigo-700 text-black px-8 py-4 rounded-full font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-2xl border-3 border-pink-400" onclick="playSound('click'); showMemoryGame()" style="background: linear-gradient(135deg, #EC4899 0%, #8B5CF6 50%, #6366F1 100%); box-shadow: 0 10px 30px rgba(236, 72, 153, 0.4), inset 0 2px 0 rgba(255, 255, 255, 0.3); text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9), 1px 1px 2px rgba(255, 255, 255, 0.8), 0 0 6px rgba(255, 255, 255, 0.6);">
                        üéÆ Cocokin Yuk! üß©
                    </button>
                </div>

                <!-- Enhanced Footer -->
                <div class="mt-8 text-center">
                    <div class="text-lg font-bold mb-4" style="color: #000000; text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9), 1px 1px 2px rgba(255, 255, 255, 0.8), 0 0 6px rgba(255, 255, 255, 0.6);">üåü Belajar Matematika Jadi Menyenangkan! üåü</div>
                    <div class="flex justify-center space-x-3 text-3xl">
                        <span class="animate-bounce floating">üéâ</span>
                        <span class="animate-bounce floating" style="animation-delay: 0.1s;">üéä</span>
                        <span class="animate-bounce floating" style="animation-delay: 0.2s;">üéà</span>
                        <span class="animate-bounce floating" style="animation-delay: 0.3s;">üéÅ</span>
                        <span class="animate-bounce floating" style="animation-delay: 0.4s;">üé™</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentSlide = 1;
        let totalSlides = 6;
        let currentQuizQuestion = 0;
        let quizQuestions = [];
        let quizAnswers = [];
        let quizScore = 0;
        let quizStartTime = null;
        let quizTimer = null;
        let quizTimeRemaining = 25 * 60; // 25 minutes in seconds
        let playerName = '';
        let isAudioPlaying = false;
        let memoryGameCards = [];
        let memoryGameFlippedCards = [];
        let memoryGameMatches = 0;
        let memoryGameTimer = null;
        let memoryGameStartTime = null;
        let memoryGameTime = 0;
        let autoAdvanceTimer = null;
        let countdownTimer = null;
        let countdownTime = 10;
        
        // Google Apps Script Configuration
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyAPmRhNAT0oHm8HRn5svCbjEeniLiF5pUIr2bgRwHlHTBBjJYPThF6TMx_z_-jaqJn/exec';
        let sessionId = null;
        let userDevice = null;
        
        // Slide completion tracking
        let slideAnswered = {
            1: false, // Slide 1 - no question, always allowed
            2: false, // Slide 2 - button question
            3: false, // Slide 3 - button question  
            4: false, // Slide 4 - text input question
            5: false, // Slide 5 - no question, always allowed
            6: false  // Slide 6 - no question, always allowed
        };

        // Google Apps Script Functions
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        function detectDevice() {
            const userAgent = navigator.userAgent;
            let device = 'Desktop';
            
            if (/Android/i.test(userAgent)) {
                device = 'Android';
            } else if (/iPhone|iPad|iPod/i.test(userAgent)) {
                device = 'iOS';
            } else if (/Windows Phone/i.test(userAgent)) {
                device = 'Windows Phone';
            } else if (/Tablet|iPad/i.test(userAgent)) {
                device = 'Tablet';
            }
            
            return device;
        }
        
        async function sendToGoogleSheets(action, data = {}) {
            try {
                const payload = {
                    action: action,
                    sessionId: sessionId,
                    playerName: playerName || 'Anonymous',
                    device: userDevice,
                    timestamp: new Date().toISOString(),
                    url: window.location.href,
                    userAgent: navigator.userAgent,
                    ...data
                };
                
                console.log('Sending to Google Sheets:', payload);
                
                // Method 1: Using fetch with form data (more reliable)
                const formData = new FormData();
                formData.append('data', JSON.stringify(payload));
                
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });
                
                console.log('Response status:', response.status);
                
                // Method 2: Fallback using image pixel tracking
                const img = new Image();
                const params = new URLSearchParams({
                    action: action,
                    sessionId: sessionId,
                    playerName: playerName || 'Anonymous',
                    device: userDevice,
                    timestamp: new Date().toISOString(),
                    data: JSON.stringify(data)
                });
                img.src = `${APPS_SCRIPT_URL}?${params.toString()}`;
                
                // Method 3: Using JSONP callback
                const script = document.createElement('script');
                script.src = `${APPS_SCRIPT_URL}?callback=handleResponse&${params.toString()}`;
                document.head.appendChild(script);
                setTimeout(() => document.head.removeChild(script), 5000);
                
            } catch (error) {
                console.error('Error sending data to Google Sheets:', error);
                
                // Fallback: Store data locally for retry
                const localData = JSON.parse(localStorage.getItem('ethnomath_data') || '[]');
                localData.push({
                    action,
                    sessionId,
                    playerName: playerName || 'Anonymous',
                    device: userDevice,
                    timestamp: new Date().toISOString(),
                    ...data
                });
                localStorage.setItem('ethnomath_data', JSON.stringify(localData));
            }
        }
        
        // JSONP callback handler
        window.handleResponse = function(response) {
            console.log('Google Sheets response:', response);
        };
        
        function initializeSession() {
            if (!sessionId) {
                sessionId = generateSessionId();
                userDevice = detectDevice();
                
                console.log('Initializing session:', {
                    sessionId,
                    userDevice,
                    url: APPS_SCRIPT_URL
                });
                
                // Send initial session data
                sendToGoogleSheets('session_start', {
                    userAgent: navigator.userAgent,
                    screenResolution: `${screen.width}x${screen.height}`,
                    language: navigator.language,
                    referrer: document.referrer,
                    pageTitle: document.title
                });
                
                // Test connection
                testGoogleSheetsConnection();
            }
        }
        
        function testGoogleSheetsConnection() {
            console.log('Testing Google Sheets connection...');
            
            // Simple test ping
            sendToGoogleSheets('connection_test', {
                testMessage: 'Connection test from ETHNOMATH app',
                testTime: Date.now()
            });
            
            // Show connection status to user (for debugging)
            setTimeout(() => {
                const localData = localStorage.getItem('ethnomath_data');
                if (localData) {
                    console.log('Data stored locally (connection may be failing):', JSON.parse(localData));
                    showCustomNotification('üì° Mencoba menghubungkan ke server...', 'info');
                } else {
                    console.log('No local data stored - connection likely working');
                }
            }, 2000);
        }
        
        // Retry failed requests
        function retryFailedRequests() {
            const localData = JSON.parse(localStorage.getItem('ethnomath_data') || '[]');
            if (localData.length > 0) {
                console.log('Retrying', localData.length, 'failed requests...');
                
                localData.forEach((item, index) => {
                    setTimeout(() => {
                        sendToGoogleSheets(item.action, item);
                    }, index * 1000); // Stagger requests
                });
                
                // Clear local storage after retry
                localStorage.removeItem('ethnomath_data');
            }
        }

        // Sound Effects
        function playSound(type) {
            console.log('Button clicked:', type);
            // Create audio context for sound effects
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                let frequency = 440;
                let duration = 0.1;
                
                switch(type) {
                    case 'click':
                        frequency = 800;
                        duration = 0.1;
                        break;
                    case 'correct':
                        frequency = 1000;
                        duration = 0.3;
                        break;
                    case 'incorrect':
                        frequency = 300;
                        duration = 0.5;
                        break;
                    case 'complete':
                        frequency = 1200;
                        duration = 0.8;
                        break;
                }
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            } catch (e) {
                // Fallback for browsers that don't support Web Audio API
                console.log('Sound effect:', type);
            }
        }

        // Custom Notification Function
        function showCustomNotification(message, type = 'info') {
            const notification = document.createElement('div');
            let bgColor = 'bg-blue-500';
            let icon = '‚ÑπÔ∏è';
            
            switch(type) {
                case 'success':
                    bgColor = 'bg-green-500';
                    icon = '‚úÖ';
                    break;
                case 'error':
                    bgColor = 'bg-red-500';
                    icon = '‚ùå';
                    break;
                case 'warning':
                    bgColor = 'bg-yellow-500';
                    icon = '‚ö†Ô∏è';
                    break;
                default:
                    bgColor = 'bg-blue-500';
                    icon = '‚ÑπÔ∏è';
            }
            
            notification.className = `fixed top-4 right-4 ${bgColor} text-white p-4 rounded-lg shadow-lg z-50 animate-bounce max-w-sm`;
            notification.innerHTML = `
                <div class="flex items-center space-x-2">
                    <span class="text-2xl">${icon}</span>
                    <div>
                        <div class="font-bold">${message}</div>
                    </div>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 3000);
        }

        // Audio Control
        function toggleAudio() {
            const audio = document.getElementById('backgroundAudio');
            const audioIcon = document.getElementById('audioIcon');
            const audioTooltip = document.getElementById('audioTooltip');
            
            if (isAudioPlaying) {
                audio.pause();
                audioIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path>';
                audioTooltip.textContent = 'Nyalakan Musik';
                isAudioPlaying = false;
            } else {
                audio.play().catch(e => console.log('Audio play failed:', e));
                audioIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>';
                audioTooltip.textContent = 'Matikan Musik';
                isAudioPlaying = true;
            }
        }

        // Page Navigation
        function showPage(pageId) {
            console.log('Navigating to page:', pageId);
            // Hide all pages
            const pages = ['homePage', 'materialPage', 'nameInputPage', 'quizPage', 'quizResultPage', 'memoryGamePage', 'hostLoginPage', 'hostDashboardPage'];
            pages.forEach(page => {
                const element = document.getElementById(page);
                if (element) {
                    element.classList.add('hidden');
                }
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.remove('hidden');
            }
            
            // Show/hide host login button based on current page
            const hostButton = document.querySelector('button[onclick*="showHostLogin"]');
            if (hostButton) {
                if (pageId === 'homePage') {
                    hostButton.style.display = 'block';
                } else {
                    hostButton.style.display = 'none';
                }
            }
        }

        // Material Page Functions
        function showMaterial() {
            // Check if name is already entered
            if (!playerName) {
                showNameInputForFeature('material');
                return;
            }
            
            // Track material access
            sendToGoogleSheets('material_start', {
                feature: 'material_pembelajaran'
            });
            
            showPage('materialPage');
            currentSlide = 1;
            
            // Reset slide completion tracking
            slideAnswered = {
                1: true,  // Slide 1 - no question, always allowed
                2: false, // Slide 2 - button question
                3: false, // Slide 3 - button question  
                4: false, // Slide 4 - text input question
                5: true,  // Slide 5 - no question, always allowed
                6: true   // Slide 6 - no question, always allowed
            };
            
            showSlide(1);
        }

        // Slide Navigation Functions
        function showSlide(slideNumber) {
            // Hide all slides
            for (let i = 1; i <= totalSlides; i++) {
                const slide = document.getElementById(`slide${i}`);
                if (slide) {
                    slide.classList.add('hidden');
                }
            }
            
            // Show selected slide
            const targetSlide = document.getElementById(`slide${slideNumber}`);
            if (targetSlide) {
                targetSlide.classList.remove('hidden');
                currentSlide = slideNumber;
                
                // Track slide navigation
                sendToGoogleSheets('slide_view', {
                    slideNumber: slideNumber,
                    feature: 'material_pembelajaran'
                });
                
                // Update slide number display
                const slideNumberElement = document.getElementById('currentSlideNumber');
                if (slideNumberElement) {
                    slideNumberElement.textContent = slideNumber;
                }
                
                // Update slide indicators
                updateSlideIndicators();
                
                // Update next button state
                updateNextButtonState();
            }
        }

        function nextSlide() {
            // Check if current slide allows progression
            if (!canProgressToNextSlide()) {
                showCustomNotification('Silakan jawab pertanyaan terlebih dahulu sebelum melanjutkan!', 'warning');
                return;
            }
            
            if (currentSlide < totalSlides) {
                showSlide(currentSlide + 1);
            }
        }
        
        function canProgressToNextSlide() {
            // Slides without questions (always allow progression)
            if (currentSlide === 1 || currentSlide === 5 || currentSlide === 6) {
                return true;
            }
            
            // Slides with questions (check if answered)
            return slideAnswered[currentSlide];
        }
        
        function updateNextButtonState() {
            const nextButton = document.querySelector('.neon-button[onclick*="nextSlide"]');
            if (!nextButton) return;
            
            if (canProgressToNextSlide() || currentSlide === totalSlides) {
                nextButton.disabled = false;
                nextButton.classList.remove('opacity-50', 'cursor-not-allowed');
                nextButton.classList.add('hover:scale-105');
            } else {
                nextButton.disabled = true;
                nextButton.classList.add('opacity-50', 'cursor-not-allowed');
                nextButton.classList.remove('hover:scale-105');
            }
        }

        function previousSlide() {
            if (currentSlide > 1) {
                showSlide(currentSlide - 1);
            }
        }

        function updateSlideIndicators() {
            const indicators = document.querySelectorAll('.slide-indicator');
            indicators.forEach((indicator, index) => {
                if (index + 1 === currentSlide) {
                    indicator.classList.remove('bg-gray-300');
                    indicator.classList.add('bg-blue-500', 'active');
                } else {
                    indicator.classList.remove('bg-blue-500', 'active');
                    indicator.classList.add('bg-gray-300');
                }
            });
        }

        // Slide 1 Popup Functions
        function showSlide1Popup() {
            playSound('correct');
            const modal = document.getElementById('slide1PopupModal');
            if (modal) {
                modal.classList.remove('hidden');
            }
        }

        function hideSlide1Popup() {
            const modal = document.getElementById('slide1PopupModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        // Slide 4 Popup Functions
        function showSlide4Popup() {
            playSound('correct');
            const modal = document.getElementById('slide4PopupModal');
            if (modal) {
                modal.classList.remove('hidden');
            }
        }

        function hideSlide4Popup() {
            const modal = document.getElementById('slide4PopupModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        // Name Input Functions
        function showNameInput() {
            showNameInputForFeature('quiz');
        }
        
        function showNameInputForFeature(feature) {
            // Store which feature was requested
            window.requestedFeature = feature;
            showPage('nameInputPage');
            
            // Update the page title and description based on feature
            const titleElement = document.querySelector('#nameInputPage h2');
            const descriptionElement = document.querySelector('#nameInputPage p');
            const buttonElement = document.querySelector('#startQuizBtn');
            
            if (titleElement && descriptionElement && buttonElement) {
                switch(feature) {
                    case 'material':
                        titleElement.innerHTML = 'üìù Masukkan Nama';
                        descriptionElement.innerHTML = 'Siapa nama kamu?';
                        buttonElement.innerHTML = 'üìñ Mulai Materi Pembelajaran';
                        break;
                    case 'quiz':
                        titleElement.innerHTML = 'üìù Masukkan Nama';
                        descriptionElement.innerHTML = 'Siapa nama kamu?';
                        buttonElement.innerHTML = 'üöÄ Mulai Latihan Soal';
                        break;
                    case 'memory':
                        titleElement.innerHTML = 'üìù Masukkan Nama';
                        descriptionElement.innerHTML = 'Siapa nama kamu?';
                        buttonElement.innerHTML = 'üéÆ Mulai Game Cocokin Yuk!';
                        break;
                }
            }
        }

        function checkNameInput() {
            const nameInput = document.getElementById('playerName');
            const nameError = document.getElementById('nameError');
            const startBtn = document.getElementById('startQuizBtn');
            
            if (!nameInput || !nameError || !startBtn) return;
            
            const name = nameInput.value.trim();
            
            if (name.length < 2) {
                nameError.classList.remove('hidden');
                startBtn.disabled = true;
                nameInput.style.borderColor = '#EF4444';
            } else {
                nameError.classList.add('hidden');
                startBtn.disabled = false;
                nameInput.style.borderColor = '#10B981';
            }
        }

        function startQuizWithName() {
            const nameInput = document.getElementById('playerName');
            const name = nameInput.value.trim();
            
            if (name.length < 2) {
                checkNameInput();
                return;
            }
            
            playerName = name;
            
            // Track name input
            sendToGoogleSheets('name_entered', {
                playerName: playerName,
                requestedFeature: window.requestedFeature || 'quiz'
            });
            
            // Determine which feature to start based on what was requested
            const requestedFeature = window.requestedFeature || 'quiz';
            
            switch(requestedFeature) {
                case 'material':
                    // Track material access
                    sendToGoogleSheets('material_start', {
                        feature: 'material_pembelajaran'
                    });
                    
                    showPage('materialPage');
                    currentSlide = 1;
                    
                    // Reset slide completion tracking
                    slideAnswered = {
                        1: true,  // Slide 1 - no question, always allowed
                        2: false, // Slide 2 - button question
                        3: false, // Slide 3 - button question  
                        4: false, // Slide 4 - text input question
                        5: true,  // Slide 5 - no question, always allowed
                        6: true   // Slide 6 - no question, always allowed
                    };
                    
                    showSlide(1);
                    break;
                case 'quiz':
                    initializeQuiz();
                    showPage('quizPage');
                    break;
                case 'memory':
                    showPage('memoryGamePage');
                    initMemoryGame();
                    break;
            }
        }

        // Quiz Functions
        function startQuiz() {
            const nameInput = document.getElementById('playerName');
            const name = nameInput ? nameInput.value.trim() : playerName;
            
            if (!name) {
                showNameInput();
                return;
            }
            
            playerName = name;
            initializeQuiz();
            showPage('quizPage');
        }

        function initializeQuiz() {
            // Track quiz start
            sendToGoogleSheets('quiz_start', {
                feature: 'latihan_soal',
                totalQuestions: 12
            });
            
            // Initialize quiz questions with structured data
            quizQuestions = [
                {
                    title: "Pertanyaan 1",
                    description: "Perhatikan gambar kain corak insang berikut!",
                    image: "https://i.imgur.com/6FTTPjc.jpg",
                    context: "Pada gambar terdapat dua segitiga, yaitu segitiga dengan garis tepi merah dan segitiga dengan garis tepi hitam. Diketahui panjang sisi alas segitiga merah adalah 12 cm, dan tinggi segitiga merah adalah 8 cm. Segitiga hitam berada di dalam segitiga merah dan sebangun dengan segitiga merah. Panjang sisi alas segitiga hitam adalah 6 cm.",
                    subQuestion: "Apakah segitiga merah dan segitiga hitam sebangun?",
                    options: ["Ya", "Tidak"],
                    correct: 0,
                    explanation: "Ya, segitiga merah dan segitiga hitam sebangun karena memiliki bentuk yang sama dan sudut-sudut yang bersesuaian sama besar."
                },
                {
                    title: "Pertanyaan 1",
                    description: "Perhatikan gambar kain corak insang berikut!",
                    image: "https://i.imgur.com/6FTTPjc.jpg",
                    context: "Pada gambar terdapat dua segitiga, yaitu segitiga dengan garis tepi merah dan segitiga dengan garis tepi hitam. Diketahui panjang sisi alas segitiga merah adalah 12 cm, dan tinggi segitiga merah adalah 8 cm. Segitiga hitam berada di dalam segitiga merah dan sebangun dengan segitiga merah. Panjang sisi alas segitiga hitam adalah 6 cm.",
                    subQuestion: "Tentukan perbandingan panjang sisi segitiga merah dan segitiga hitam.",
                    options: ["‚Öì", "¬Ω"],
                    correct: 1,
                    explanation: "Perbandingan sisi = alas segitiga hitam : alas segitiga merah = 6 : 12 = ¬Ω"
                },
                {
                    title: "Pertanyaan 1",
                    description: "Perhatikan gambar kain corak insang berikut!",
                    image: "https://i.imgur.com/6FTTPjc.jpg",
                    context: "Pada gambar terdapat dua segitiga, yaitu segitiga dengan garis tepi merah dan segitiga dengan garis tepi hitam. Diketahui panjang sisi alas segitiga merah adalah 12 cm, dan tinggi segitiga merah adalah 8 cm. Segitiga hitam berada di dalam segitiga merah dan sebangun dengan segitiga merah. Panjang sisi alas segitiga hitam adalah 6 cm.",
                    subQuestion: "Berapa tinggi segitiga hitam?",
                    options: ["6", "4"],
                    correct: 1,
                    explanation: "Karena segitiga sebangun, perbandingan tinggi = perbandingan alas = ¬Ω. Tinggi segitiga hitam = 8 √ó ¬Ω = 4 cm"
                },
                {
                    title: "Pertanyaan 1",
                    description: "Perhatikan gambar kain corak insang berikut!",
                    image: "https://i.imgur.com/6FTTPjc.jpg",
                    context: "Pada gambar terdapat dua segitiga, yaitu segitiga dengan garis tepi merah dan segitiga dengan garis tepi hitam. Diketahui panjang sisi alas segitiga merah adalah 12 cm, dan tinggi segitiga merah adalah 8 cm. Segitiga hitam berada di dalam segitiga merah dan sebangun dengan segitiga merah. Panjang sisi alas segitiga hitam adalah 6 cm.",
                    subQuestion: "Jika luas segitiga merah adalah Lm, dan luas segitiga hitam adalah Lh, tentukan perbandingan Lh dan Lm!",
                    options: ["¬º", "‚Öë"],
                    correct: 0,
                    explanation: "Perbandingan luas = kuadrat perbandingan sisi = (¬Ω)¬≤ = ¬º"
                },
                {
                    title: "Pertanyaan 2",
                    description: "Perhatikan gambar berikut!",
                    image: "https://i.imgur.com/60w7w1L.jpg",
                    context: "Atap rumah adat Melayu berbentuk segitiga sama kaki dengan alas 8 m dan tinggi 4,5 m. Di bawah atap utama ada segitiga hiasan dengan alas 3,2 m.",
                    subQuestion: "Apa yang ditanyakan dalam soal?",
                    options: ["Luas segitiga besar", "Tinggi segitiga hiasan"],
                    correct: 1,
                    explanation: "Yang ditanyakan adalah tinggi segitiga hiasan yang sebangun dengan segitiga atap utama."
                },
                {
                    title: "Pertanyaan 2",
                    description: "Perhatikan gambar berikut!",
                    image: "https://i.imgur.com/60w7w1L.jpg",
                    context: "Atap rumah adat Melayu berbentuk segitiga sama kaki dengan alas 8 m dan tinggi 4,5 m. Di bawah atap utama ada segitiga hiasan dengan alas 3,2 m.",
                    subQuestion: "Segitiga hiasan dan segitiga besar adalah ‚Ä¶",
                    options: ["Sebangun", "Tidak sebangun"],
                    correct: 0,
                    explanation: "Segitiga hiasan dan segitiga besar sebangun karena memiliki bentuk yang sama (sama-sama segitiga sama kaki)."
                },
                {
                    title: "Pertanyaan 2",
                    description: "Perhatikan gambar berikut!",
                    image: "https://i.imgur.com/2GcWm8J.jpg",
                    context: "Atap rumah adat Melayu berbentuk segitiga sama kaki dengan alas 8 m dan tinggi 4,5 m. Di bawah atap utama ada segitiga hiasan dengan alas 3,2 m.",
                    subQuestion: "Perbandingan alas kedua segitiga adalah:",
                    options: ["0,4", "0,6"],
                    correct: 0,
                    explanation: "Perbandingan alas = 3,2 : 8 = 0,4"
                },
                {
                    title: "Pertanyaan 2",
                    description: "Perhatikan gambar berikut!",
                    image: "https://i.imgur.com/60w7w1L.jpg",
                    context: "Atap rumah adat Melayu berbentuk segitiga sama kaki dengan alas 8 m dan tinggi 4,5 m. Di bawah atap utama ada segitiga hiasan dengan alas 3,2 m.",
                    subQuestion: "Tinggi segitiga hiasan adalah ‚Ä¶",
                    options: ["1,8 m", "2,5 m"],
                    correct: 0,
                    explanation: "Tinggi segitiga hiasan = 4,5 √ó 0,4 = 1,8 m"
                },
                {
                    title: "Pertanyaan 3",
                    description: "Perhatikan gambar berikut.",
                    image: "https://i.imgur.com/KguukHd.jpg",
                    context: "Pintu rumah adat Melayu di atas terdiri dari pintu besar dan pola panel persegi panjang di dalamnya. Panel-panel tersebut sebangun dengan bentuk pintu secara keseluruhan. Pintu rumah adat Melayu memiliki tinggi 210 cm dan lebar 90 cm. Panel di dalam pintu memiliki lebar 30 cm dan sebangun dengan pintu utama.",
                    subQuestion: "Apa yang ditanyakan pada soal ini?",
                    options: ["tinggi panel", "lebar pintu utama"],
                    correct: 0,
                    explanation: "Yang ditanyakan adalah tinggi panel yang sebangun dengan pintu utama."
                },
                {
                    title: "Pertanyaan 3",
                    description: "Perhatikan gambar berikut.",
                    image: "https://i.imgur.com/KguukHd.jpg",
                    context: "Pintu rumah adat Melayu di atas terdiri dari pintu besar dan pola panel persegi panjang di dalamnya. Panel-panel tersebut sebangun dengan bentuk pintu secara keseluruhan. Pintu rumah adat Melayu memiliki tinggi 210 cm dan lebar 90 cm. Panel di dalam pintu memiliki lebar 30 cm dan sebangun dengan pintu utama.",
                    subQuestion: "Rumus kesebangunan yang tepat digunakan adalah ‚Ä¶",
                    subQuestionImage: "https://i.imgur.com/FpFnPXB.jpg",
                    options: ["https://i.imgur.com/FpFnPXB.jpg", "https://i.imgur.com/8RIOUZ4.jpg"],
                    correct: 0,
                    explanation: "Rumus yang tepat adalah perbandingan tinggi panel dengan tinggi pintu sama dengan perbandingan lebar panel dengan lebar pintu."
                },
                {
                    title: "Pertanyaan 3",
                    description: "Perhatikan gambar berikut.",
                    image: "https://i.imgur.com/KguukHd.jpg",
                    context: "Pintu rumah adat Melayu di atas terdiri dari pintu besar dan pola panel persegi panjang di dalamnya. Panel-panel tersebut sebangun dengan bentuk pintu secara keseluruhan. Pintu rumah adat Melayu memiliki tinggi 210 cm dan lebar 90 cm. Panel di dalam pintu memiliki lebar 30 cm dan sebangun dengan pintu utama.",
                    subQuestion: "Berapa tinggi panel?",
                    options: ["70", "90"],
                    correct: 0,
                    explanation: "Tinggi panel = 210 √ó (30/90) = 210 √ó ‚Öì = 70 cm"
                },
                {
                    title: "Pertanyaan 3",
                    description: "Perhatikan gambar berikut.",
                    image: "https://i.imgur.com/KguukHd.jpg",
                    context: "Pintu rumah adat Melayu di atas terdiri dari pintu besar dan pola panel persegi panjang di dalamnya. Panel-panel tersebut sebangun dengan bentuk pintu secara keseluruhan. Pintu rumah adat Melayu memiliki tinggi 210 cm dan lebar 90 cm. Panel di dalam pintu memiliki lebar 30 cm dan sebangun dengan pintu utama.",
                    subQuestion: "Apakah benar perbandingan tinggi dan lebar pada kedua bangun sama?",
                    subQuestionImage: "https://i.imgur.com/HpeORSM.jpg",
                    options: ["Ya, sama ‚Üí hasil benar", "Tidak, berbeda ‚Üí hasil salah"],
                    correct: 0,
                    explanation: "Ya, perbandingan tinggi dan lebar pada kedua bangun sama karena keduanya sebangun. Perbandingan pintu = 210:90 = 7:3, dan perbandingan panel = 70:30 = 7:3"
                }
            ];
            
            // Reset quiz state
            currentQuizQuestion = 0;
            quizScore = 0;
            quizAnswers = [];
            quizTimeRemaining = 25 * 60; // 25 minutes
            
            // Update player name display
            const playerNameElement = document.getElementById('playerNameDisplay');
            if (playerNameElement) {
                playerNameElement.textContent = playerName;
            }
            
            // Start timer
            startQuizTimer();
            
            // Show first question
            showQuizQuestion();
        }

        function startQuizTimer() {
            if (quizTimer) {
                clearInterval(quizTimer);
            }
            
            quizTimer = setInterval(() => {
                quizTimeRemaining--;
                updateQuizTimerDisplay();
                
                if (quizTimeRemaining <= 0) {
                    clearInterval(quizTimer);
                    finishQuiz();
                }
            }, 1000);
        }

        function updateQuizTimerDisplay() {
            const minutes = Math.floor(quizTimeRemaining / 60);
            const seconds = quizTimeRemaining % 60;
            const timerElement = document.getElementById('quizTimer');
            if (timerElement) {
                timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        function showQuizQuestion() {
            const question = quizQuestions[currentQuizQuestion];
            
            if (!question) return;
            
            // Update header elements
            const titleElement = document.getElementById('quizQuestionTitle');
            const descriptionElement = document.getElementById('quizQuestionDescription');
            const contextElement = document.getElementById('quizQuestionContext');
            const subQuestionElement = document.getElementById('quizSubQuestion');
            const imageContainer = document.getElementById('quizImageContainer');
            const subQuestionImageContainer = document.getElementById('quizQuestionImageContainer');
            const quizOptions = document.getElementById('quizOptions');
            const quizProgress = document.getElementById('quizProgress2');
            
            if (titleElement) {
                titleElement.textContent = question.title;
            }
            
            if (descriptionElement) {
                descriptionElement.textContent = question.description;
            }
            
            if (contextElement) {
                contextElement.textContent = question.context;
            }
            
            if (subQuestionElement) {
                subQuestionElement.textContent = question.subQuestion;
            }
            
            // Update progress
            if (quizProgress) {
                quizProgress.textContent = currentQuizQuestion + 1;
            }
            
            // Update main image
            if (imageContainer && question.image) {
                imageContainer.innerHTML = `
                    <img src="${question.image}" alt="Soal ${currentQuizQuestion + 1}" class="max-h-48 mx-auto rounded-lg shadow-lg" onerror="this.style.display='none';">
                `;
            }
            
            // Update sub-question image if exists
            if (subQuestionImageContainer && question.subQuestionImage) {
                subQuestionImageContainer.classList.remove('hidden');
                subQuestionImageContainer.innerHTML = `
                    <img src="${question.subQuestionImage}" alt="Sub Question Image" class="max-h-32 mx-auto rounded-lg shadow-lg mb-4" onerror="this.style.display='none';">
                `;
            } else if (subQuestionImageContainer) {
                subQuestionImageContainer.classList.add('hidden');
            }
            
            // Check if this question has already been answered
            const existingAnswer = quizAnswers.find(answer => answer.question === currentQuizQuestion);
            
            // Update quiz options
            if (quizOptions) {
                quizOptions.innerHTML = question.options.map((option, index) => {
                    let buttonClass = "quiz-option w-full text-left";
                    let onclickAction = `selectQuizAnswer(${index})`;
                    
                    // If question was already answered, show the locked state
                    if (existingAnswer) {
                        onclickAction = ""; // Remove onclick
                        buttonClass += " cursor-not-allowed opacity-75";
                        
                        if (index === existingAnswer.selected) {
                            buttonClass += " selected";
                        }
                        if (index === question.correct) {
                            buttonClass += " correct";
                        } else if (index === existingAnswer.selected && index !== question.correct) {
                            buttonClass += " incorrect";
                        }
                    }
                    
                    // Check if option is an image URL
                    if (option.startsWith('https://')) {
                        return `
                            <button class="${buttonClass} flex items-center justify-center p-4" ${existingAnswer ? '' : `onclick="${onclickAction}"`}>
                                <div class="flex items-center space-x-4">
                                    <span class="text-xl font-bold">${String.fromCharCode(65 + index)}.</span>
                                    <img src="${option}" alt="Option ${String.fromCharCode(65 + index)}" class="max-h-16 rounded-lg shadow-md" onerror="this.style.display='none';">
                                </div>
                            </button>
                        `;
                    } else {
                        return `
                            <button class="${buttonClass}" ${existingAnswer ? '' : `onclick="${onclickAction}"`}>
                                ${String.fromCharCode(65 + index)}. ${option}
                            </button>
                        `;
                    }
                }).join('');
            }
            
            // If question was already answered, enable next button immediately
            if (existingAnswer) {
                const nextBtn = document.getElementById('quizNextBtn');
                if (nextBtn) {
                    nextBtn.disabled = false;
                    nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                }
                
                // Hide countdown for already answered questions
                const countdownElement = document.getElementById('autoAdvanceCountdown');
                if (countdownElement) {
                    countdownElement.classList.add('hidden');
                }
            }
            
            // Update navigation buttons
            updateQuizNavigation();
        }

        function updateQuizNavigation() {
            const prevBtn = document.getElementById('quizPrevBtn');
            const nextBtn = document.getElementById('quizNextBtn');
            
            // Update previous button
            if (prevBtn) {
                prevBtn.disabled = currentQuizQuestion === 0;
            }
            
            // Update next button - check if current question has been answered
            if (nextBtn) {
                const existingAnswer = quizAnswers.find(answer => answer.question === currentQuizQuestion);
                if (existingAnswer) {
                    // Question already answered, enable next button
                    nextBtn.disabled = false;
                    nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    // Question not answered yet, disable next button
                    nextBtn.disabled = true;
                    nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
                }
            }
        }

        function selectQuizAnswer(selectedIndex) {
            const question = quizQuestions[currentQuizQuestion];
            const options = document.querySelectorAll('.quiz-option');
            
            // Disable all options
            options.forEach(option => {
                option.style.pointerEvents = 'none';
            });
            
            // Mark selected option
            options[selectedIndex].classList.add('selected');
            
            // Show correct/incorrect
            setTimeout(() => {
                options.forEach((option, index) => {
                    if (index === question.correct) {
                        option.classList.add('correct');
                    } else if (index === selectedIndex && index !== question.correct) {
                        option.classList.add('incorrect');
                    }
                });
                
                // Update score
                if (selectedIndex === question.correct) {
                    quizScore++;
                    playSound('correct');
                } else {
                    playSound('incorrect');
                }
                
                // Store answer
                const answerData = {
                    question: currentQuizQuestion,
                    selected: selectedIndex,
                    correct: question.correct,
                    isCorrect: selectedIndex === question.correct
                };
                quizAnswers.push(answerData);
                
                // Track quiz answer
                sendToGoogleSheets('quiz_answer', {
                    questionNumber: currentQuizQuestion + 1,
                    selectedAnswer: selectedIndex,
                    correctAnswer: question.correct,
                    isCorrect: selectedIndex === question.correct,
                    questionTitle: question.title,
                    feature: 'latihan_soal'
                });
                
                // Update score display
                const scoreElement = document.getElementById('quizCorrectCount');
                if (scoreElement) {
                    scoreElement.textContent = quizScore;
                }
                
                // Show simple popup feedback
                setTimeout(() => {
                    if (selectedIndex === question.correct) {
                        showCustomNotification('‚úÖ Jawaban Benar!', 'success');
                    } else {
                        showCustomNotification('‚ùå Jawaban Salah!', 'error');
                    }
                }, 500);
                
                // Enable next button and start countdown
                const nextBtn = document.getElementById('quizNextBtn');
                if (nextBtn) {
                    nextBtn.disabled = false;
                }
                
                // Start auto-advance countdown
                startAutoAdvanceCountdown();
                
            }, 1000);
        }

        function startAutoAdvanceCountdown() {
            const countdownElement = document.getElementById('autoAdvanceCountdown');
            const timerElement = document.getElementById('countdownTimer');
            
            if (countdownElement && timerElement) {
                countdownElement.classList.remove('hidden');
                countdownTime = 10;
                timerElement.textContent = countdownTime;
                
                countdownTimer = setInterval(() => {
                    countdownTime--;
                    timerElement.textContent = countdownTime;
                    
                    if (countdownTime <= 0) {
                        clearInterval(countdownTimer);
                        nextQuizQuestion();
                    }
                }, 1000);
            }
        }

        function previousQuizQuestion() {
            if (currentQuizQuestion > 0) {
                // Clear any active countdown
                if (countdownTimer) {
                    clearInterval(countdownTimer);
                }
                
                currentQuizQuestion--;
                showQuizQuestion();
            }
        }

        function nextQuizQuestion() {
            // Clear any active countdown
            if (countdownTimer) {
                clearInterval(countdownTimer);
            }
            
            // Hide countdown
            const countdownElement = document.getElementById('autoAdvanceCountdown');
            if (countdownElement) {
                countdownElement.classList.add('hidden');
            }
            
            currentQuizQuestion++;
            
            if (currentQuizQuestion >= quizQuestions.length) {
                finishQuiz();
            } else {
                showQuizQuestion();
            }
        }

        function confirmExitQuiz() {
            const modal = document.getElementById('quizExitModal');
            if (modal) {
                modal.classList.remove('hidden');
            }
        }

        function exitQuiz() {
            // Clear timers
            if (quizTimer) clearInterval(quizTimer);
            if (countdownTimer) clearInterval(countdownTimer);
            
            // Hide modal
            const modal = document.getElementById('quizExitModal');
            if (modal) {
                modal.classList.add('hidden');
            }
            
            // Go to home page
            showPage('homePage');
        }

        function closeExitQuiz() {
            const modal = document.getElementById('quizExitModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        function finishQuiz() {
            clearInterval(quizTimer);
            
            // Calculate final score based on stored answers
            let finalScore = 0;
            quizAnswers.forEach(answer => {
                if (answer.isCorrect) {
                    finalScore++;
                }
            });
            
            // Update the global quiz score
            quizScore = finalScore;
            
            // Calculate completion time
            const totalTime = (25 * 60) - quizTimeRemaining;
            const minutes = Math.floor(totalTime / 60);
            const seconds = totalTime % 60;
            const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // Track quiz completion
            sendToGoogleSheets('quiz_complete', {
                finalScore: quizScore,
                totalQuestions: quizQuestions.length,
                completionTime: timeString,
                completionTimeSeconds: totalTime,
                percentage: Math.round((quizScore / quizQuestions.length) * 100),
                feature: 'latihan_soal'
            });
            
            showQuizResults();
        }

        function showQuizResults() {
            const totalTime = (25 * 60) - quizTimeRemaining;
            const minutes = Math.floor(totalTime / 60);
            const seconds = totalTime % 60;
            const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            let emoji, message, title;
            
            if (quizScore >= 11) {
                title = 'Luar Biasa!';
                emoji = "üèÜ";
                message = "Kamu menguasai materi kesebangunan dengan sangat baik!";
            } else if (quizScore >= 9) {
                title = 'Hebat!';
                emoji = "üéâ";
                message = "Pemahaman kamu tentang kesebangunan sudah bagus!";
            } else if (quizScore >= 7) {
                title = 'Bagus!';
                emoji = "üëè";
                message = "Kamu sudah memahami konsep dasar kesebangunan!";
            } else if (quizScore >= 5) {
                title = 'Cukup Baik!';
                emoji = "üìö";
                message = "Terus belajar untuk memahami kesebangunan lebih baik!";
            } else {
                title = 'Semangat!';
                emoji = "üí™";
                message = "Jangan menyerah! Coba pelajari materi lagi dan ulangi quiz!";
            }
            
            // Update modal elements
            const resultEmoji = document.getElementById('quizResultEmoji');
            const resultTitle = document.getElementById('quizResultTitle');
            const finalScore = document.getElementById('quizFinalScore');
            const totalQuestions = document.getElementById('quizTotalQuestions');
            const finalTime = document.getElementById('quizFinalTime');
            const scoreMessage = document.getElementById('quizScoreMessage');
            
            if (resultEmoji) {
                resultEmoji.textContent = emoji;
            }
            
            if (resultTitle) {
                resultTitle.textContent = title;
            }
            
            if (finalScore) {
                finalScore.textContent = quizScore;
            }
            
            if (totalQuestions) {
                totalQuestions.textContent = quizQuestions.length;
            }
            
            if (finalTime) {
                finalTime.textContent = timeString;
            }
            
            if (scoreMessage) {
                scoreMessage.textContent = message;
            }
            
            playSound('complete');
            
            // Show modal instead of page
            const modal = document.getElementById('quizResultsModal');
            if (modal) {
                modal.classList.remove('hidden');
            }
        }

        function restartQuiz() {
            showPage('homePage');
        }

        function closeQuizResults() {
            const modal = document.getElementById('quizResultsModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        // Memory Game Functions
        function showMemoryGame() {
            // Always check if name is entered, regardless of previous input
            const nameInput = document.getElementById('playerName');
            const currentName = nameInput ? nameInput.value.trim() : playerName;
            
            if (!currentName || currentName.length < 2) {
                showNameInputForFeature('memory');
                return;
            }
            
            // Update playerName if it was entered in the input
            if (currentName && currentName !== playerName) {
                playerName = currentName;
            }
            
            showPage('memoryGamePage');
            initMemoryGame();
        }

        // Memory Game Card Pairs
        const memoryCardPairs = [
            ['https://i.imgur.com/b1Zlbkt.png', 'https://i.imgur.com/Ejy16gR.png'],
            ['https://i.imgur.com/80ICXOO.png', 'https://i.imgur.com/gcJxB4M.png'],
            ['https://i.imgur.com/Veak9do.png', 'https://i.imgur.com/w12jWLf.png'],
            ['https://i.imgur.com/0fxX71F.png', 'https://i.imgur.com/bsv7VA7.png'],
            ['https://i.imgur.com/hDz2ArX.png', 'https://i.imgur.com/974FBWr.png'],
            ['https://i.imgur.com/2witPyO.png', 'https://i.imgur.com/xte0thx.png']
        ];

        function initMemoryGame() {
            // Track memory game start
            sendToGoogleSheets('memory_game_start', {
                feature: 'cocokin_yuk',
                totalPairs: 6
            });
            
            memoryGameCards = [];
            
            // Create cards from pairs
            memoryCardPairs.forEach((pair, pairIndex) => {
                memoryGameCards.push(
                    { id: pairIndex + 1, image: pair[0], matched: false },
                    { id: pairIndex + 1, image: pair[1], matched: false }
                );
            });
            
            // Shuffle cards
            memoryGameCards = shuffleArray(memoryGameCards);
            
            // Reset game state
            memoryGameFlippedCards = [];
            memoryGameMatches = 0;
            memoryGameTime = 0;
            
            // Create game board
            createMemoryGameBoard();
            
            // Start timer
            memoryGameStartTime = Date.now();
            memoryGameTimer = setInterval(updateMemoryGameTimer, 1000);
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function createMemoryGameBoard() {
            const board = document.getElementById('memoryGameBoard');
            if (!board) return;
            
            board.innerHTML = '';
            
            memoryGameCards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'memory-card';
                cardElement.innerHTML = `
                    <div class="card-front" style="display: none;">
                        <img src="${card.image}" alt="Rebana ${index + 1}" style="width: 100%; height: 100%; object-fit: contain;" onerror="this.src=''; this.alt='Rebana ${index + 1}'; this.style.display='none';">
                    </div>
                    <div class="card-back" style="display: flex; align-items: center; justify-content: center;">
                        <img src="https://i.imgur.com/HUKC9Y7.png" alt="Cover Game" style="width: 100%; height: 100%; object-fit: contain;" onerror="this.src=''; this.alt='Cover Game'; this.style.display='none';">
                    </div>
                `;
                cardElement.onclick = () => flipMemoryCard(index);
                board.appendChild(cardElement);
            });
        }

        function flipMemoryCard(index) {
            if (memoryGameFlippedCards.length >= 2) return;
            if (memoryGameCards[index].matched) return;
            if (memoryGameFlippedCards.includes(index)) return;
            
            const cardElement = document.querySelectorAll('.memory-card')[index];
            const front = cardElement.querySelector('.card-front');
            const back = cardElement.querySelector('.card-back');
            
            // Flip card
            front.style.display = 'flex';
            front.style.alignItems = 'center';
            front.style.justifyContent = 'center';
            back.style.display = 'none';
            cardElement.classList.add('flipped');
            
            memoryGameFlippedCards.push(index);
            
            if (memoryGameFlippedCards.length === 2) {
                setTimeout(checkMemoryGameMatch, 1000);
            }
        }

        function checkMemoryGameMatch() {
            const [first, second] = memoryGameFlippedCards;
            const firstCard = memoryGameCards[first];
            const secondCard = memoryGameCards[second];
            
            if (firstCard.id === secondCard.id) {
                // Match found
                firstCard.matched = true;
                secondCard.matched = true;
                
                const cardElements = document.querySelectorAll('.memory-card');
                cardElements[first].classList.add('matched');
                cardElements[second].classList.add('matched');
                
                memoryGameMatches++;
                const matchesElement = document.getElementById('memoryGameMatches');
                if (matchesElement) {
                    matchesElement.textContent = memoryGameMatches;
                }
                
                // Track match found
                sendToGoogleSheets('memory_game_match', {
                    matchNumber: memoryGameMatches,
                    pairId: firstCard.id,
                    currentTime: Math.floor((Date.now() - memoryGameStartTime) / 1000),
                    feature: 'cocokin_yuk'
                });
                
                playSound('correct');
                
                // Check if game is complete
                if (memoryGameMatches === 6) {
                    setTimeout(finishMemoryGame, 500);
                }
            } else {
                // No match, flip back
                const cardElements = document.querySelectorAll('.memory-card');
                const firstFront = cardElements[first].querySelector('.card-front');
                const firstBack = cardElements[first].querySelector('.card-back');
                const secondFront = cardElements[second].querySelector('.card-front');
                const secondBack = cardElements[second].querySelector('.card-back');
                
                firstFront.style.display = 'none';
                firstBack.style.display = 'flex';
                secondFront.style.display = 'none';
                secondBack.style.display = 'flex';
                
                cardElements[first].classList.remove('flipped');
                cardElements[second].classList.remove('flipped');
                
                playSound('incorrect');
            }
            
            memoryGameFlippedCards = [];
        }

        function updateMemoryGameTimer() {
            memoryGameTime = Math.floor((Date.now() - memoryGameStartTime) / 1000);
            const minutes = Math.floor(memoryGameTime / 60);
            const seconds = memoryGameTime % 60;
            const timerElement = document.getElementById('memoryGameTimer');
            if (timerElement) {
                timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        function finishMemoryGame() {
            clearInterval(memoryGameTimer);
            playSound('complete');
            
            // Calculate final time
            const minutes = Math.floor(memoryGameTime / 60);
            const seconds = memoryGameTime % 60;
            const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // Track memory game completion
            sendToGoogleSheets('memory_game_complete', {
                completionTime: timeString,
                completionTimeSeconds: memoryGameTime,
                totalMatches: memoryGameMatches,
                feature: 'cocokin_yuk'
            });
            
            // Update modal content
            const finalTimeElement = document.getElementById('memoryFinalTime');
            const scoreMessageElement = document.getElementById('memoryScoreMessage');
            const resultEmojiElement = document.getElementById('memoryResultEmoji');
            
            if (finalTimeElement) {
                finalTimeElement.textContent = timeString;
            }
            
            // Set message based on time
            let message = "Hebat sekali!";
            let emoji = "üéâ";
            
            if (memoryGameTime <= 60) {
                message = "Luar biasa! Kamu sangat cepat! üöÄ";
                emoji = "üèÜ";
            } else if (memoryGameTime <= 120) {
                message = "Bagus sekali! Waktu yang sangat baik! ‚≠ê";
                emoji = "üåü";
            } else if (memoryGameTime <= 180) {
                message = "Tidak buruk! Terus berlatih ya! üëç";
                emoji = "üëè";
            } else {
                message = "Selamat! Kamu berhasil menyelesaikannya! üéä";
                emoji = "üéâ";
            }
            
            if (scoreMessageElement) {
                scoreMessageElement.textContent = message;
            }
            
            if (resultEmojiElement) {
                resultEmojiElement.textContent = emoji;
            }
            
            // Show modal
            const modal = document.getElementById('memoryGameResultsModal');
            if (modal) {
                modal.classList.remove('hidden');
            }
        }

        function resetMemoryGame() {
            initMemoryGame();
        }

        function restartMemoryGame() {
            closeMemoryGameResults();
            initMemoryGame();
        }

        function closeMemoryGameResults() {
            const modal = document.getElementById('memoryGameResultsModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        // Host Functions
        function showHostLogin() {
            showPage('hostLoginPage');
        }
        
        function loginHost() {
            const passwordInput = document.getElementById('hostPassword');
            const password = passwordInput.value.trim();
            
            // Password untuk demo (dalam implementasi nyata, gunakan sistem autentikasi yang lebih aman)
            const correctPassword = 'host123';
            
            if (password === correctPassword) {
                playSound('correct');
                showCustomNotification('Login berhasil! Selamat datang di dashboard host.', 'success');
                
                // Track host login
                sendToGoogleSheets('host_login', {
                    loginTime: new Date().toISOString(),
                    feature: 'host_dashboard'
                });
                
                // Show dashboard
                showPage('hostDashboardPage');
                
                // Initialize dashboard data
                initializeDashboard();
            } else {
                playSound('incorrect');
                showCustomNotification('Password salah! Coba lagi.', 'error');
                passwordInput.value = '';
                passwordInput.focus();
            }
        }
        
        function initializeDashboard() {
            // Initialize dashboard with real data (starts from 0)
            const dashboardData = {
                totalUsers: 0,
                totalQuizzes: 0,
                totalGames: 0,
                totalMaterials: 0
            };
            
            // Update dashboard counters (no animation needed for 0 values)
            updateDashboardCounter('totalUsers', dashboardData.totalUsers);
            updateDashboardCounter('totalQuizzes', dashboardData.totalQuizzes);
            updateDashboardCounter('totalGames', dashboardData.totalGames);
            updateDashboardCounter('totalMaterials', dashboardData.totalMaterials);
            
            // Show overview tab by default
            showDashboardTab('overview');
            
            // Load real data from tracking (in real implementation, this would fetch from Google Sheets)
            loadRealDashboardData();
        }
        
        function updateDashboardCounter(elementId, value) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = value;
            }
        }
        
        function animateCounter(elementId, targetValue) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            let currentValue = 0;
            const increment = Math.ceil(targetValue / 20);
            const timer = setInterval(() => {
                currentValue += increment;
                if (currentValue >= targetValue) {
                    currentValue = targetValue;
                    clearInterval(timer);
                }
                element.textContent = currentValue;
            }, 50);
        }
        
        function loadRealDashboardData() {
            // In real implementation, this would fetch data from Google Sheets
            // For now, we'll simulate real-time updates based on actual user activity
            
            // Create a simple counter system that tracks actual usage
            let realData = {
                users: new Set(), // Track unique users
                quizzes: 0,
                games: 0,
                materials: 0
            };
            
            // Add current session if exists
            if (sessionId && playerName) {
                realData.users.add(sessionId);
            }
            
            // Update counters with real data
            updateDashboardCounter('totalUsers', realData.users.size);
            updateDashboardCounter('totalQuizzes', realData.quizzes);
            updateDashboardCounter('totalGames', realData.games);
            updateDashboardCounter('totalMaterials', realData.materials);
            
            // Set up periodic updates (every 30 seconds)
            setInterval(() => {
                // In real implementation, this would fetch fresh data from Google Sheets
                // For demo purposes, we'll keep it at 0 unless there's actual activity
                console.log('Dashboard data refreshed');
            }, 30000);
        }
        
        function showDashboardTab(tabName) {
            // Hide all tabs
            const tabs = ['overviewTab', 'usersTab', 'quizTab', 'gameTab'];
            tabs.forEach(tab => {
                const element = document.getElementById(tab);
                if (element) {
                    element.classList.add('hidden');
                }
            });
            
            // Show selected tab
            const selectedTab = document.getElementById(tabName + 'Tab');
            if (selectedTab) {
                selectedTab.classList.remove('hidden');
            }
            
            // Update tab buttons
            const tabButtons = document.querySelectorAll('.dashboard-tab');
            tabButtons.forEach(button => {
                button.classList.remove('active');
                button.className = button.className.replace('from-blue-500 to-indigo-600', 'from-gray-400 to-gray-500');
            });
            
            // Activate selected tab button
            const activeButton = event?.target || document.querySelector('.dashboard-tab');
            if (activeButton) {
                activeButton.classList.add('active');
                activeButton.className = activeButton.className.replace('from-gray-400 to-gray-500', 'from-blue-500 to-indigo-600');
            }
            
            playSound('click');
        }

        // Interactive Slide Functions
        function checkSlide4Answer() {
            const textarea = document.getElementById('slide4Answer');
            const feedback = document.getElementById('slide4Feedback');
            
            if (!textarea || !feedback) return;
            
            const answer = textarea.value.trim();
            
            if (answer.length >= 10) {
                feedback.classList.remove('hidden');
                // Mark slide as answered
                slideAnswered[4] = true;
                
                // Track slide 4 text answer (only once when first completed)
                if (!slideAnswered[4]) {
                    sendToGoogleSheets('slide_answer', {
                        slideNumber: 4,
                        answer: answer,
                        answerLength: answer.length,
                        feature: 'material_pembelajaran'
                    });
                }
                
                // Update next button state
                updateNextButtonState();
            } else {
                feedback.classList.add('hidden');
                // Mark slide as not answered
                slideAnswered[4] = false;
                // Update next button state
                updateNextButtonState();
            }
        }

        function answerSlide2(answer) {
            playSound('click');
            const buttons = document.getElementById('slide2-buttons');
            const feedback = document.getElementById('slide2-feedback');
            
            // Mark slide as answered
            slideAnswered[2] = true;
            
            // Track slide answer
            sendToGoogleSheets('slide_answer', {
                slideNumber: 2,
                answer: answer,
                isCorrect: answer === 'sama',
                feature: 'material_pembelajaran'
            });
            
            // Hide buttons
            buttons.classList.add('hidden');
            
            // Show feedback
            feedback.classList.remove('hidden');
            
            if (answer === 'sama') {
                feedback.className = 'mt-6 p-4 rounded-lg bg-green-100 border-l-4 border-green-500';
                feedback.innerHTML = `
                    <h4 class="font-bold text-green-800 mb-2">‚úÖ Benar!</h4>
                    <p class="text-green-700">Ya, kamu benar. Segitiga putih dan segitiga merah memiliki bentuk yang sama.</p>
                `;
                playSound('correct');
            } else {
                feedback.className = 'mt-6 p-4 rounded-lg bg-red-100 border-l-4 border-red-500';
                feedback.innerHTML = `
                    <h4 class="font-bold text-red-800 mb-2">‚ùå Belum Tepat</h4>
                    <p class="text-red-700">Belum tepat. Jawaban yang benar adalah segitiga putih dan segitiga merah memiliki bentuk yang sama.</p>
                `;
                playSound('incorrect');
            }
            
            // Update next button state
            updateNextButtonState();
        }

        function answerSlide3(answer) {
            playSound('click');
            const buttons = document.getElementById('slide3-buttons');
            const feedback = document.getElementById('slide3-feedback');
            const explanation = document.getElementById('slide3-explanation');
            
            // Mark slide as answered
            slideAnswered[3] = true;
            
            // Track slide answer
            sendToGoogleSheets('slide_answer', {
                slideNumber: 3,
                answer: answer,
                isCorrect: answer === 'sama',
                feature: 'material_pembelajaran'
            });
            
            // Hide buttons
            buttons.classList.add('hidden');
            
            // Show feedback
            feedback.classList.remove('hidden');
            
            if (answer === 'sama') {
                feedback.className = 'mt-6 p-4 rounded-lg bg-green-100 border-l-4 border-green-500';
                feedback.innerHTML = `
                    <h4 class="font-bold text-green-800 mb-2">‚úÖ Benar!</h4>
                    <p class="text-green-700">Ya, kamu benar. Sudut-sudut dan perbandingan sisi-sisi yang bersesuaian sama. Karena segitiga merah terbentuk dari garis yang sejajar dengan alas segitiga putih. Sehingga sudut-sudut yang bersesuaian sama besar. Jika dua segitiga memiliki sudut-sudut yang bersesuaian sama besar, maka sisi-sisi yang bersesuaian memiliki perbandingan yang sama.</p>
                `;
                playSound('correct');
            } else {
                feedback.className = 'mt-6 p-4 rounded-lg bg-red-100 border-l-4 border-red-500';
                feedback.innerHTML = `
                    <h4 class="font-bold text-red-800 mb-2">‚ùå Belum Tepat</h4>
                    <p class="text-red-700">Belum tepat. Jawaban yang benar adalah sudut-sudut dan perbandingan sisi-sisi yang bersesuaian sama. Karena segitiga merah terbentuk dari garis yang sejajar dengan alas segitiga putih. Sehingga sudut-sudut yang bersesuaian sama besar. Jika dua segitiga memiliki sudut-sudut yang bersesuaian sama besar, maka sisi-sisi yang bersesuaian memiliki perbandingan yang sama.</p>
                `;
                playSound('incorrect');
            }
            
            // Always show explanation image
            explanation.classList.remove('hidden');
            
            // Update next button state
            updateNextButtonState();
        }

        // Debug Panel Functions
        function createDebugPanel() {
            const debugPanel = document.createElement('div');
            debugPanel.id = 'debugPanel';
            debugPanel.style.cssText = `
                position: fixed;
                top: 60px;
                right: 10px;
                width: 300px;
                background: rgba(0,0,0,0.8);
                color: white;
                padding: 10px;
                border-radius: 8px;
                font-size: 12px;
                z-index: 1000;
                display: none;
                max-height: 400px;
                overflow-y: auto;
            `;
            
            debugPanel.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 10px;">üìä Debug Panel</div>
                <div id="debugContent">
                    <div>Session ID: <span id="debugSessionId">-</span></div>
                    <div>Device: <span id="debugDevice">-</span></div>
                    <div>Player: <span id="debugPlayer">-</span></div>
                    <div>Requests Sent: <span id="debugRequests">0</span></div>
                    <div>Local Storage: <span id="debugLocalStorage">0</span></div>
                    <hr style="margin: 10px 0;">
                    <div id="debugLog" style="max-height: 200px; overflow-y: auto; font-size: 10px;"></div>
                </div>
                <button onclick="toggleDebugPanel()" style="margin-top: 10px; padding: 5px; background: #333; color: white; border: none; border-radius: 4px; cursor: pointer;">Hide</button>
            `;
            
            document.body.appendChild(debugPanel);
        }
        
        function toggleDebugPanel() {
            const panel = document.getElementById('debugPanel');
            if (panel) {
                panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                updateDebugPanel();
            }
        }
        
        function updateDebugPanel() {
            const sessionIdEl = document.getElementById('debugSessionId');
            const deviceEl = document.getElementById('debugDevice');
            const playerEl = document.getElementById('debugPlayer');
            const requestsEl = document.getElementById('debugRequests');
            const localStorageEl = document.getElementById('debugLocalStorage');
            
            if (sessionIdEl) sessionIdEl.textContent = sessionId || '-';
            if (deviceEl) deviceEl.textContent = userDevice || '-';
            if (playerEl) playerEl.textContent = playerName || 'Anonymous';
            if (requestsEl) requestsEl.textContent = window.debugRequestCount || 0;
            
            const localData = JSON.parse(localStorage.getItem('ethnomath_data') || '[]');
            if (localStorageEl) localStorageEl.textContent = localData.length;
        }
        
        function addDebugLog(message) {
            const logEl = document.getElementById('debugLog');
            if (logEl) {
                const time = new Date().toLocaleTimeString();
                logEl.innerHTML += `<div>[${time}] ${message}</div>`;
                logEl.scrollTop = logEl.scrollHeight;
            }
        }
        
        // Enhanced sendToGoogleSheets with debug logging
        const originalSendToGoogleSheets = sendToGoogleSheets;
        sendToGoogleSheets = async function(action, data = {}) {
            window.debugRequestCount = (window.debugRequestCount || 0) + 1;
            addDebugLog(`üì§ Sending: ${action}`);
            updateDebugPanel();
            
            try {
                await originalSendToGoogleSheets(action, data);
                addDebugLog(`‚úÖ Sent: ${action}`);
            } catch (error) {
                addDebugLog(`‚ùå Failed: ${action} - ${error.message}`);
            }
        };
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize session tracking
            initializeSession();
            
            // Create debug panel
            createDebugPanel();
            
            // Initialize audio
            const audio = document.getElementById('backgroundAudio');
            if (audio) {
                audio.volume = 0.3;
            }
            
            // Auto-play audio (will only work after user interaction)
            document.addEventListener('click', function() {
                if (!isAudioPlaying && audio) {
                    audio.play().catch(e => console.log('Audio autoplay prevented'));
                    isAudioPlaying = true;
                }
            }, { once: true });
            
            // Add debug toggle button (triple click on title)
            let clickCount = 0;
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('game-title')) {
                    clickCount++;
                    setTimeout(() => clickCount = 0, 1000);
                    if (clickCount === 3) {
                        toggleDebugPanel();
                        clickCount = 0;
                    }
                }
            });
            
            // Retry failed requests on page load
            setTimeout(retryFailedRequests, 3000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'992fe72461805f51',t:'MTc2MTIwODU0Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
