<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EthoMath - Game Kuis Kesebangunan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
        }
        
        .basketball {
            width: 35px;
            height: 35px;
            background: linear-gradient(45deg, #ff8c00, #ffa500);
            border-radius: 50%;
            position: absolute;
            box-shadow: 0 4px 15px rgba(255, 140, 0, 0.4);
            transition: all 0.8s ease;
            z-index: 10;
            border: 2px solid #8b4513;
        }
        
        .basketball::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 2px;
            height: 100%;
            background: #8b4513;
        }
        
        .basketball::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 2px;
            background: #8b4513;
        }
        
        .basketball.shooting {
            animation: basketShoot 2.5s ease-in-out;
        }
        
        .basketball.scored {
            animation: basketScore 1.5s ease-out;
        }
        
        .basketball.missed {
            animation: basketMiss 2s ease-out;
        }
        
        @keyframes basketShoot {
            0% { transform: translateY(0) translateX(0) scale(1) rotate(0deg); }
            30% { transform: translateY(-120px) translateX(120px) scale(0.9) rotate(180deg); }
            60% { transform: translateY(-160px) translateX(240px) scale(0.8) rotate(360deg); }
            80% { transform: translateY(-140px) translateX(320px) scale(0.9) rotate(540deg); }
            100% { transform: translateY(-130px) translateX(380px) scale(1) rotate(720deg); }
        }
        
        @keyframes basketScore {
            0% { transform: translateY(-130px) translateX(380px) scale(1); }
            20% { transform: translateY(-125px) translateX(385px) scale(0.9); background: linear-gradient(45deg, #32cd32, #00ff00); }
            40% { transform: translateY(-120px) translateX(390px) scale(0.8); }
            60% { transform: translateY(-100px) translateX(395px) scale(0.7); }
            80% { transform: translateY(-60px) translateX(400px) scale(0.6); }
            100% { transform: translateY(20px) translateX(405px) scale(0.4); opacity: 0; }
        }
        
        @keyframes basketMiss {
            0% { transform: translateY(-130px) scale(1) rotate(720deg); }
            30% { transform: translateY(-120px) translateX(420px) scale(0.9) rotate(900deg); }
            60% { transform: translateY(-80px) translateX(450px) scale(0.8) rotate(1080deg); }
            100% { transform: translateY(150px) translateX(480px) scale(0.5) rotate(1260deg); opacity: 0; }
        }
        
        .player {
            width: 70px;
            height: 90px;
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .player-avatar {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            margin-bottom: 5px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.3);
            border: 3px solid #fff;
        }
        
        .player-name {
            font-size: 0.75rem;
            font-weight: 700;
            text-align: center;
            color: #1f2937;
            background: rgba(255,255,255,0.95);
            padding: 3px 8px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .player.shooting .player-avatar {
            animation: playerShoot 0.8s ease-out;
        }
        
        .player.celebrating .player-avatar {
            animation: playerCelebrate 1.5s ease-out;
        }
        
        .player.disappointed .player-avatar {
            animation: playerDisappointed 1s ease-out;
        }
        
        @keyframes playerShoot {
            0% { transform: scale(1) translateY(0); }
            40% { transform: scale(1.1) translateY(-15px); }
            70% { transform: scale(1.05) translateY(-8px); }
            100% { transform: scale(1) translateY(0); }
        }
        
        @keyframes playerCelebrate {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(-10deg) translateY(-10px); }
            50% { transform: scale(1.3) rotate(10deg) translateY(-15px); }
            75% { transform: scale(1.2) rotate(-5deg) translateY(-10px); }
            100% { transform: scale(1) rotate(0deg) translateY(0); }
        }
        
        @keyframes playerDisappointed {
            0% { transform: scale(1); }
            50% { transform: scale(0.9) translateY(8px); }
            100% { transform: scale(1) translateY(0); }
        }
        
        .basketball-court {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ffd700 100%);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            border: 4px solid #8b4513;
        }
        
        .basketball-court::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.1) 75%), 
                        linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.1) 75%);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            opacity: 0.3;
        }
        
        .basketball-hoop {
            position: absolute;
            width: 80px;
            height: 60px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .hoop-rim {
            width: 60px;
            height: 8px;
            background: linear-gradient(to bottom, #ff4500, #ff6347);
            border-radius: 50px;
            border: 2px solid #8b0000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .hoop-net {
            width: 50px;
            height: 40px;
            border-left: 2px solid #fff;
            border-right: 2px solid #fff;
            border-bottom: 2px solid #fff;
            border-radius: 0 0 25px 25px;
            position: relative;
            margin-top: -2px;
        }
        
        .hoop-net::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 100%;
            background: #fff;
        }
        
        .hoop-backboard {
            width: 70px;
            height: 50px;
            background: linear-gradient(to bottom, #f0f0f0, #d0d0d0);
            border: 3px solid #333;
            border-radius: 5px;
            position: absolute;
            top: -25px;
            right: -5px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .hoop-backboard::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 25px;
            height: 18px;
            border: 2px solid #ff4500;
            border-radius: 3px;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .celebration {
            animation: celebration 2s ease-in-out;
        }
        
        @keyframes celebration {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(5deg); }
        }
        
        .swish-effect {
            position: absolute;
            top: 120px;
            right: 70px;
            color: #32cd32;
            font-size: 2rem;
            font-weight: bold;
            opacity: 0;
            animation: swishText 2s ease-out;
            z-index: 20;
        }
        
        @keyframes swishText {
            0% { opacity: 0; transform: scale(0.5) translateY(20px); }
            30% { opacity: 1; transform: scale(1.2) translateY(-10px); }
            70% { opacity: 1; transform: scale(1) translateY(-20px); }
            100% { opacity: 0; transform: scale(0.8) translateY(-40px); }
        }
        
        .music-visualizer {
            display: inline-flex;
            align-items: center;
            gap: 2px;
            margin-left: 8px;
        }
        
        .music-bar {
            width: 3px;
            height: 12px;
            background: #fff;
            border-radius: 2px;
            animation: musicBounce 1s ease-in-out infinite;
        }
        
        .music-bar:nth-child(2) { animation-delay: 0.1s; }
        .music-bar:nth-child(3) { animation-delay: 0.2s; }
        .music-bar:nth-child(4) { animation-delay: 0.3s; }
        
        @keyframes musicBounce {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }
    </style>
</head>
<body class="min-h-screen relative">
    <!-- Background SVG -->
    <div class="fixed inset-0 z-0">
        <svg width="100%" height="100%" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid slice" class="w-full h-full object-cover">
            <!-- Sky Gradient -->
            <defs>
                <linearGradient id="skyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#87CEEB;stop-opacity:1" />
                    <stop offset="70%" style="stop-color:#FFE4B5;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#FFA500;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="riverGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#4682B4;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#2F4F4F;stop-opacity:1" />
                </linearGradient>
            </defs>
            
            <!-- Sky -->
            <rect width="1200" height="800" fill="url(#skyGradient)"/>
            
            <!-- Mountains/Hills in background -->
            <path d="M0,300 Q200,250 400,280 T800,260 L1200,280 L1200,800 L0,800 Z" fill="#228B22" opacity="0.3"/>
            
            <!-- Traditional Pontianak Houses -->
            <!-- House 1 -->
            <g>
                <!-- House base -->
                <rect x="100" y="400" width="200" height="150" fill="#D2691E" stroke="#A0522D" stroke-width="2"/>
                <!-- Roof -->
                <polygon points="80,400 200,300 320,400" fill="#B22222" stroke="#800000" stroke-width="2"/>
                <!-- Door -->
                <rect x="140" y="480" width="30" height="70" fill="#654321"/>
                <!-- Windows -->
                <rect x="180" y="430" width="40" height="40" fill="#87CEEB" stroke="#000" stroke-width="1"/>
                <rect x="120" y="430" width="40" height="40" fill="#87CEEB" stroke="#000" stroke-width="1"/>
                <!-- Stilts/Pillars -->
                <rect x="120" y="550" width="8" height="50" fill="#8B4513"/>
                <rect x="160" y="550" width="8" height="50" fill="#8B4513"/>
                <rect x="200" y="550" width="8" height="50" fill="#8B4513"/>
                <rect x="240" y="550" width="8" height="50" fill="#8B4513"/>
            </g>
            
            <!-- House 2 -->
            <g>
                <rect x="400" y="380" width="180" height="170" fill="#DEB887" stroke="#A0522D" stroke-width="2"/>
                <polygon points="380,380 490,280 600,380" fill="#B22222" stroke="#800000" stroke-width="2"/>
                <rect x="440" y="460" width="25" height="60" fill="#654321"/>
                <rect x="500" y="410" width="35" height="35" fill="#87CEEB" stroke="#000" stroke-width="1"/>
                <rect x="540" y="450" width="35" height="35" fill="#87CEEB" stroke="#000" stroke-width="1"/>
                <!-- Stilts -->
                <rect x="420" y="550" width="8" height="50" fill="#8B4513"/>
                <rect x="460" y="550" width="8" height="50" fill="#8B4513"/>
                <rect x="500" y="550" width="8" height="50" fill="#8B4513"/>
                <rect x="540" y="550" width="8" height="50" fill="#8B4513"/>
            </g>
            
            <!-- House 3 -->
            <g>
                <rect x="700" y="420" width="160" height="130" fill="#F4A460" stroke="#A0522D" stroke-width="2"/>
                <polygon points="680,420 780,320 880,420" fill="#B22222" stroke="#800000" stroke-width="2"/>
                <rect x="730" y="480" width="25" height="50" fill="#654321"/>
                <rect x="800" y="450" width="30" height="30" fill="#87CEEB" stroke="#000" stroke-width="1"/>
                <!-- Stilts -->
                <rect x="720" y="550" width="8" height="50" fill="#8B4513"/>
                <rect x="760" y="550" width="8" height="50" fill="#8B4513"/>
                <rect x="820" y="550" width="8" height="50" fill="#8B4513"/>
            </g>
            
            <!-- Trees and vegetation -->
            <ellipse cx="150" cy="380" rx="30" ry="50" fill="#006400"/>
            <ellipse cx="350" cy="370" rx="25" ry="45" fill="#228B22"/>
            <ellipse cx="650" cy="390" rx="35" ry="55" fill="#006400"/>
            <ellipse cx="950" cy="380" rx="30" ry="50" fill="#228B22"/>
            <ellipse cx="50" cy="400" rx="20" ry="40" fill="#006400"/>
            <ellipse cx="1100" cy="390" rx="25" ry="45" fill="#228B22"/>
            
            <!-- Ground/Grass -->
            <rect x="0" y="600" width="1200" height="50" fill="#228B22"/>
            
            <!-- Kapuas River -->
            <path d="M0,650 Q300,630 600,650 T1200,650 L1200,800 L0,800 Z" fill="url(#riverGradient)"/>
            
            <!-- River reflections -->
            <ellipse cx="200" cy="720" rx="80" ry="15" fill="#87CEEB" opacity="0.3"/>
            <ellipse cx="490" cy="710" rx="90" ry="12" fill="#87CEEB" opacity="0.3"/>
            <ellipse cx="780" cy="725" rx="70" ry="10" fill="#87CEEB" opacity="0.3"/>
            
            <!-- Boats on river -->
            <ellipse cx="300" cy="680" rx="25" ry="8" fill="#8B4513"/>
            <ellipse cx="800" cy="690" rx="30" ry="10" fill="#654321"/>
            
            <!-- Clouds -->
            <ellipse cx="200" cy="100" rx="40" ry="25" fill="#FFFFFF" opacity="0.8"/>
            <ellipse cx="220" cy="90" rx="35" ry="20" fill="#FFFFFF" opacity="0.8"/>
            <ellipse cx="600" cy="80" rx="50" ry="30" fill="#FFFFFF" opacity="0.7"/>
            <ellipse cx="630" cy="70" rx="40" ry="25" fill="#FFFFFF" opacity="0.7"/>
            <ellipse cx="1000" cy="120" rx="45" ry="28" fill="#FFFFFF" opacity="0.6"/>
        </svg>
        
        <!-- Dark overlay for better text readability -->
        <div class="absolute inset-0 bg-black bg-opacity-30"></div>
    </div>
    
    <!-- Content wrapper -->
    <div class="relative z-10">
    <!-- Audio Elements -->
    <audio id="backgroundMusic" loop preload="auto" volume="0.3">
        <!-- Menggunakan link audio yang dapat diakses -->
        <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
        <source src="https://actions.google.com/sounds/v1/alarms/bugle_tune.ogg" type="audio/ogg">
        <!-- Fallback untuk musik game -->
        <source src="https://www.zapsplat.com/wp-content/uploads/2015/sound-effects-one/zapsplat_multimedia_game_sound_bright_positive_musical_tone_001_19735.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="correctSound" preload="auto" volume="0.5">
        <source src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" type="audio/ogg">
        <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
    </audio>
    
    <audio id="wrongSound" preload="auto" volume="0.4">
        <source src="https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg" type="audio/ogg">
        <source src="https://www.soundjay.com/misc/sounds/fail-buzzer-02.wav" type="audio/wav">
    </audio>
    
    <!-- Opening Screen -->
    <div id="openingScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full text-center fade-in">
            <div class="mb-8">
                <div class="w-32 h-32 mx-auto mb-6 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center">
                    <span class="text-6xl">🎓</span>
                </div>
                <h1 class="text-4xl font-bold text-gray-800 mb-2">EthoMath</h1>
                <p class="text-xl text-gray-600 mb-6">Game Kuis Matematika Kesebangunan</p>
            </div>
            
            <div class="bg-gray-50 rounded-2xl p-6 mb-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">👨‍🏫 Profil Pembuat</h2>
                <div class="flex items-center justify-center space-x-4">
                    <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center">
                        <span class="text-2xl text-white">👨‍💻</span>
                    </div>
                    <div class="text-left">
                        <h3 class="font-semibold text-gray-800">Guru Matematika</h3>
                        <p class="text-gray-600">Spesialis Geometri & Kesebangunan</p>
                        <p class="text-sm text-gray-500">Pengalaman 10+ tahun mengajar</p>
                    </div>
                </div>
            </div>
            
            <div class="space-y-4">
                <button onclick="showMaterial()" class="w-full bg-gradient-to-r from-green-500 to-blue-500 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                    📚 Pelajari Materi Kesebangunan
                </button>
                <button onclick="showRoleSelection()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                    🎮 Mulai Bermain
                </button>
            </div>
        </div>
    </div>
    
    <!-- Role Selection Screen -->
    <div id="roleSelection" class="min-h-screen flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center fade-in">
            <h2 class="text-3xl font-bold text-gray-800 mb-8">Pilih Peran Anda</h2>
            <div class="space-y-4">
                <button onclick="showPlayerLogin()" class="w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                    👨‍🎓 Masuk sebagai Pemain
                </button>
                <button onclick="showHostLogin()" class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                    👨‍🏫 Masuk sebagai Host
                </button>
                <button onclick="showOpeningScreen()" class="w-full bg-gray-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-gray-600 transition-colors">
                    ← Kembali
                </button>
            </div>
        </div>
    </div>
    
    <!-- Player Login Screen -->
    <div id="playerLogin" class="min-h-screen flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center fade-in">
            <h2 class="text-3xl font-bold text-gray-800 mb-8">Masuk sebagai Pemain</h2>
            <div class="space-y-4">
                <input type="text" id="playerName" placeholder="Masukkan nama Anda" class="w-full p-4 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none text-lg">
                <button onclick="startGame()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                    🎮 Mulai Game
                </button>
                <button onclick="showRoleSelection()" class="w-full bg-gray-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-gray-600 transition-colors">
                    ← Kembali
                </button>
            </div>
        </div>
    </div>
    
    <!-- Host Login Screen -->
    <div id="hostLogin" class="min-h-screen flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center fade-in">
            <h2 class="text-3xl font-bold text-gray-800 mb-8">Panel Host</h2>
            <div class="space-y-4">
                <input type="password" id="hostPassword" placeholder="Masukkan password host" class="w-full p-4 border-2 border-gray-300 rounded-xl focus:border-orange-500 focus:outline-none text-lg">
                <button onclick="loginHost()" class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                    🔑 Masuk sebagai Host
                </button>
                <button onclick="showRoleSelection()" class="w-full bg-gray-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-gray-600 transition-colors">
                    ← Kembali
                </button>
            </div>
        </div>
    </div>
    
    <!-- Host Dashboard -->
    <div id="hostDashboard" class="min-h-screen p-4 hidden">
        <div class="max-w-6xl mx-auto">
            <div class="bg-white rounded-3xl shadow-2xl p-8 mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">🎯 Dashboard Host EthoMath</h2>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-blue-50 p-6 rounded-2xl">
                        <h3 class="text-xl font-semibold text-blue-800 mb-2">👥 Pemain Aktif</h3>
                        <p class="text-3xl font-bold text-blue-600" id="activePlayersCount">0</p>
                    </div>
                    <div class="bg-green-50 p-6 rounded-2xl">
                        <h3 class="text-xl font-semibold text-green-800 mb-2">🎮 Game Dimainkan</h3>
                        <p class="text-3xl font-bold text-green-600" id="gamesPlayedCount">0</p>
                    </div>
                    <div class="bg-purple-50 p-6 rounded-2xl">
                        <h3 class="text-xl font-semibold text-purple-800 mb-2">⭐ Rata-rata Skor</h3>
                        <p class="text-3xl font-bold text-purple-600" id="averageScore">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-3xl shadow-2xl p-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">📊 Leaderboard Real-time</h3>
                <div id="hostLeaderboard" class="space-y-3">
                    <p class="text-gray-500 text-center py-8">Belum ada data pemain</p>
                </div>
            </div>
            
            <div class="mt-6 text-center">
                <button onclick="showRoleSelection()" class="bg-gray-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-gray-600 transition-colors">
                    ← Kembali ke Menu
                </button>
            </div>
        </div>
    </div>
    
    <!-- Material Screen -->
    <div id="materialScreen" class="min-h-screen p-4 hidden">
        <div class="max-w-4xl mx-auto">
            <div class="bg-white rounded-3xl shadow-2xl p-8 fade-in">
                <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">📐 Materi Kesebangunan</h2>
                
                <div class="space-y-8">
                    <div class="bg-blue-50 p-6 rounded-2xl">
                        <h3 class="text-2xl font-semibold text-blue-800 mb-4">🔍 Apa itu Kesebangunan?</h3>
                        <p class="text-gray-700 leading-relaxed mb-4">
                            Kesebangunan adalah konsep dalam geometri dimana dua bangun datar memiliki bentuk yang sama tetapi ukurannya berbeda. 
                            Bangun-bangun yang sebangun memiliki sudut-sudut yang bersesuaian sama besar dan sisi-sisi yang bersesuaian sebanding.
                        </p>
                    </div>
                    
                    <div class="bg-green-50 p-6 rounded-2xl">
                        <h3 class="text-2xl font-semibold text-green-800 mb-4">📏 Ciri-ciri Bangun Sebangun</h3>
                        <ul class="list-disc list-inside text-gray-700 space-y-2">
                            <li>Sudut-sudut yang bersesuaian sama besar</li>
                            <li>Sisi-sisi yang bersesuaian sebanding</li>
                            <li>Perbandingan sisi-sisi yang bersesuaian sama (skala)</li>
                        </ul>
                    </div>
                    
                    <div class="bg-purple-50 p-6 rounded-2xl">
                        <h3 class="text-2xl font-semibold text-purple-800 mb-4">🧮 Contoh Soal</h3>
                        <div class="bg-white p-4 rounded-xl">
                            <p class="text-gray-700 mb-2">
                                <strong>Soal:</strong> Segitiga ABC sebangun dengan segitiga DEF. Jika AB = 6 cm, BC = 8 cm, dan DE = 9 cm, 
                                berapakah panjang EF?
                            </p>
                            <p class="text-gray-700">
                                <strong>Jawab:</strong> Karena sebangun, maka AB/DE = BC/EF<br>
                                6/9 = 8/EF<br>
                                EF = (8 × 9)/6 = 12 cm
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-8">
                    <button onclick="showOpeningScreen()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 px-8 rounded-xl font-semibold text-lg hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                        ← Kembali ke Menu Utama
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Game Screen -->
    <div id="gameScreen" class="min-h-screen p-4 hidden">
        <div class="max-w-6xl mx-auto">
            <!-- Game Header -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6 flex justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">🎮 EthoMath Game</h2>
                    <p class="text-gray-600">Pemain: <span id="currentPlayerName" class="font-semibold"></span></p>
                    <button onclick="toggleMusic()" id="musicToggle" class="mt-2 bg-blue-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-blue-600 transition-colors flex items-center">
                        🎵 Musik: ON
                        <div class="music-visualizer ml-2" id="musicVisualizer">
                            <div class="music-bar"></div>
                            <div class="music-bar"></div>
                            <div class="music-bar"></div>
                            <div class="music-bar"></div>
                        </div>
                    </button>
                </div>
                <div class="text-center">
                    <p class="text-lg font-semibold text-red-600">⏰ Waktu Tersisa</p>
                    <p class="text-2xl font-bold text-red-600" id="gameTimer">15:00</p>
                </div>
                <div class="text-right">
                    <p class="text-lg font-semibold text-purple-600">Soal <span id="questionNumber">1</span>/5</p>
                    <p class="text-2xl font-bold text-green-600">Skor: <span id="currentScore">0</span></p>
                </div>
            </div>
            
            <!-- Question Area -->
            <div class="bg-white rounded-3xl shadow-2xl p-8 mb-6">
                <div id="questionArea" class="mb-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4" id="questionText"></h3>
                    <div id="questionDiagram" class="flex justify-center mb-6"></div>
                    <div id="questionOptions" class="grid grid-cols-2 gap-4"></div>
                </div>
            </div>
            
            <!-- Game Field -->
            <div class="bg-white rounded-3xl shadow-2xl p-6 mb-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4 text-center">🏀 Arena Basket EthoMath</h3>
                <div class="basketball-court relative" style="height: 300px;">
                    <!-- Single Basketball Hoop (centered) -->
                    <div class="basketball-hoop" style="top: 120px; right: 50px;">
                        <div class="hoop-backboard"></div>
                        <div class="hoop-rim"></div>
                        <div class="hoop-net"></div>
                    </div>
                    
                    <!-- Single Basketball -->
                    <div id="currentBall" class="basketball" style="left: 80px; top: 150px;"></div>
                    
                    <!-- Current Player -->
                    <div id="currentPlayer" class="player" style="left: 150px; top: 130px;">
                        <div id="currentPlayerAvatar" class="player-avatar" style="background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);">🏀</div>
                        <div id="currentPlayerName" class="player-name">Alex</div>
                    </div>
                    
                    <!-- SWISH Effect -->
                    <div id="swishEffect" class="swish-effect">SWISH! 🎯</div>
                    
                    <!-- Game Status -->
                    <div id="gameStatus" class="absolute top-4 left-4 bg-white bg-opacity-90 px-4 py-2 rounded-xl text-lg font-semibold text-gray-700 shadow-lg">
                        🏀 Pilih jawaban untuk menembak!
                    </div>
                    
                    <!-- Question Progress -->
                    <div id="questionProgress" class="absolute bottom-4 left-4 bg-white bg-opacity-90 px-4 py-2 rounded-xl text-sm font-semibold text-gray-600 shadow-lg">
                        Pemain: <span id="progressPlayerName">Alex</span> | Soal <span id="progressQuestionNumber">1</span>/5
                    </div>
                </div>
            </div>
            
            <div class="text-center">
                <button onclick="showOpeningScreen()" class="bg-gray-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-gray-600 transition-colors">
                    🏠 Kembali ke Menu
                </button>
            </div>
        </div>
    </div>
    
    <!-- Leaderboard Screen -->
    <div id="leaderboardScreen" class="min-h-screen p-4 hidden">
        <div class="max-w-2xl mx-auto">
            <div class="bg-white rounded-3xl shadow-2xl p-8 text-center fade-in">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">🏆 Leaderboard</h2>
                <p class="text-gray-600 mb-8">Skor Tertinggi EthoMath</p>
                
                <div id="leaderboardList" class="space-y-4 mb-8">
                    <!-- Leaderboard akan diisi oleh JavaScript -->
                </div>
                
                <div class="space-y-4">
                    <button onclick="startGame()" class="w-full bg-gradient-to-r from-green-500 to-blue-500 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                        🔄 Main Lagi
                    </button>
                    <button onclick="showOpeningScreen()" class="w-full bg-gray-500 text-white py-3 px-6 rounded-xl font-semibold hover:bg-gray-600 transition-colors">
                        🏠 Menu Utama
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let currentPlayer = '';
        let currentQuestion = 0;
        let currentScore = 0;
        let gameQuestions = [];
        let leaderboard = JSON.parse(localStorage.getItem('ethomath_leaderboard') || '[]');
        let hostStats = JSON.parse(localStorage.getItem('ethomath_host_stats') || '{"activePlayersCount": 0, "gamesPlayedCount": 0, "totalScore": 0}');
        let gameTimer = null;
        let timeRemaining = 900; // 15 minutes in seconds
        let musicEnabled = true;
        
        // Basketball Players Data (1 player per question)
        const basketballPlayers = [
            { name: "Alex", avatar: "🏀", gradient: "linear-gradient(135deg, #ff6b35 0%, #f7931e 100%)" },
            { name: "Maya", avatar: "⛹️‍♀️", gradient: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)" },
            { name: "Rio", avatar: "⛹️‍♂️", gradient: "linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)" },
            { name: "Luna", avatar: "🏀", gradient: "linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)" },
            { name: "Dani", avatar: "⛹️‍♂️", gradient: "linear-gradient(135deg, #fa709a 0%, #fee140 100%)" }
        ];
        
        // Questions Database
        const questionsDB = [
            {
                question: "Segitiga ABC sebangun dengan segitiga DEF. Jika AB = 6 cm, BC = 8 cm, dan DE = 9 cm, berapakah panjang EF?",
                options: ["10 cm", "12 cm", "14 cm", "16 cm"],
                correct: 1,
                explanation: "Karena sebangun: AB/DE = BC/EF → 6/9 = 8/EF → EF = 12 cm",
                diagram: `<svg width="400" height="200" viewBox="0 0 400 200">
                    <polygon points="50,150 150,50 200,150" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                    <text x="100" y="40" font-size="14" fill="#1976d2" font-weight="bold">A</text>
                    <text x="210" y="160" font-size="14" fill="#1976d2" font-weight="bold">B</text>
                    <text x="40" y="160" font-size="14" fill="#1976d2" font-weight="bold">C</text>
                    <text x="100" y="90" font-size="12" fill="#1976d2">6 cm</text>
                    <text x="180" y="110" font-size="12" fill="#1976d2">8 cm</text>
                    
                    <polygon points="250,150 350,50 400,150" fill="#fff3e0" stroke="#f57c00" stroke-width="2"/>
                    <text x="300" y="40" font-size="14" fill="#f57c00" font-weight="bold">D</text>
                    <text x="410" y="160" font-size="14" fill="#f57c00" font-weight="bold">E</text>
                    <text x="240" y="160" font-size="14" fill="#f57c00" font-weight="bold">F</text>
                    <text x="300" y="90" font-size="12" fill="#f57c00">9 cm</text>
                    <text x="380" y="110" font-size="12" fill="#f57c00">EF = ?</text>
                </svg>`
            },
            {
                question: "Dua persegi panjang sebangun memiliki perbandingan sisi 2:3. Jika luas persegi panjang kecil 8 cm², berapakah luas persegi panjang besar?",
                options: ["12 cm²", "16 cm²", "18 cm²", "24 cm²"],
                correct: 2,
                explanation: "Perbandingan luas = (2:3)² = 4:9 → Luas besar = 8 × 9/4 = 18 cm²",
                diagram: `<svg width="400" height="200" viewBox="0 0 400 200">
                    <rect x="50" y="80" width="80" height="60" fill="#e8f5e8" stroke="#4caf50" stroke-width="2"/>
                    <text x="90" y="75" font-size="12" fill="#4caf50">Kecil</text>
                    <text x="85" y="115" font-size="12" fill="#4caf50">8 cm²</text>
                    
                    <rect x="200" y="60" width="120" height="90" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
                    <text x="255" y="55" font-size="12" fill="#ff9800">Besar</text>
                    <text x="250" y="110" font-size="12" fill="#ff9800">? cm²</text>
                    
                    <text x="160" y="180" font-size="14" fill="#333">Perbandingan sisi = 2:3</text>
                </svg>`
            },
            {
                question: "Trapesium ABCD sebangun dengan trapesium PQRS. Jika AB = 4 cm, CD = 8 cm, dan PQ = 6 cm, berapakah panjang RS?",
                options: ["10 cm", "12 cm", "14 cm", "16 cm"],
                correct: 1,
                explanation: "Perbandingan sisi = 4:6 = 2:3 → RS = 8 × 3/2 = 12 cm",
                diagram: `<svg width="400" height="200" viewBox="0 0 400 200">
                    <polygon points="70,150 130,150 110,80 90,80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2"/>
                    <text x="85" y="75" font-size="12" fill="#9c27b0">A</text>
                    <text x="115" y="75" font-size="12" fill="#9c27b0">B</text>
                    <text x="135" y="160" font-size="12" fill="#9c27b0">C</text>
                    <text x="65" y="160" font-size="12" fill="#9c27b0">D</text>
                    <text x="95" y="70" font-size="10" fill="#9c27b0">4 cm</text>
                    <text x="95" y="170" font-size="10" fill="#9c27b0">8 cm</text>
                    
                    <polygon points="220,150 310,150 280,80 250,80" fill="#e0f2f1" stroke="#009688" stroke-width="2"/>
                    <text x="245" y="75" font-size="12" fill="#009688">P</text>
                    <text x="285" y="75" font-size="12" fill="#009688">Q</text>
                    <text x="315" y="160" font-size="12" fill="#009688">R</text>
                    <text x="215" y="160" font-size="12" fill="#009688">S</text>
                    <text x="260" y="70" font-size="10" fill="#009688">6 cm</text>
                    <text x="260" y="170" font-size="10" fill="#009688">RS = ?</text>
                </svg>`
            },
            {
                question: "Segitiga siku-siku ABC dengan siku-siku di C sebangun dengan segitiga DEF. Jika AC = 3 cm, BC = 4 cm, dan DE = 10 cm, berapakah keliling segitiga DEF?",
                options: ["24 cm", "30 cm", "36 cm", "40 cm"],
                correct: 1,
                explanation: "AB = 5 cm (teorema Pythagoras). Skala = 10:5 = 2:1. Keliling DEF = 2 × (3+4+5) = 24 cm",
                diagram: `<svg width="400" height="200" viewBox="0 0 400 200">
                    <polygon points="50,150 50,90 110,150" fill="#ffebee" stroke="#f44336" stroke-width="2"/>
                    <text x="45" y="85" font-size="12" fill="#f44336">A</text>
                    <text x="45" y="165" font-size="12" fill="#f44336">C</text>
                    <text x="115" y="165" font-size="12" fill="#f44336">B</text>
                    <text x="25" y="120" font-size="10" fill="#f44336">3 cm</text>
                    <text x="75" y="170" font-size="10" fill="#f44336">4 cm</text>
                    <rect x="45" y="145" width="10" height="10" fill="none" stroke="#f44336" stroke-width="1"/>
                    
                    <polygon points="220,150 220,30 340,150" fill="#e8f5e8" stroke="#4caf50" stroke-width="2"/>
                    <text x="215" y="25" font-size="12" fill="#4caf50">D</text>
                    <text x="215" y="165" font-size="12" fill="#4caf50">F</text>
                    <text x="345" y="165" font-size="12" fill="#4caf50">E</text>
                    <text x="270" y="95" font-size="10" fill="#4caf50">10 cm</text>
                    <rect x="215" y="145" width="10" height="10" fill="none" stroke="#4caf50" stroke-width="1"/>
                </svg>`
            },
            {
                question: "Dua lingkaran sebangun memiliki jari-jari 5 cm dan 15 cm. Jika keliling lingkaran kecil 31,4 cm, berapakah keliling lingkaran besar?",
                options: ["62,8 cm", "78,5 cm", "94,2 cm", "125,6 cm"],
                correct: 2,
                explanation: "Perbandingan jari-jari = 5:15 = 1:3. Keliling besar = 31,4 × 3 = 94,2 cm",
                diagram: `<svg width="400" height="200" viewBox="0 0 400 200">
                    <circle cx="120" cy="100" r="40" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
                    <line x1="120" y1="100" x2="160" y2="100" stroke="#2196f3" stroke-width="2"/>
                    <text x="135" y="105" font-size="10" fill="#2196f3">5 cm</text>
                    <text x="100" y="180" font-size="12" fill="#2196f3">K = 31,4 cm</text>
                    
                    <circle cx="300" cy="100" r="80" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
                    <line x1="300" y1="100" x2="380" y2="100" stroke="#ff9800" stroke-width="2"/>
                    <text x="335" y="105" font-size="10" fill="#ff9800">15 cm</text>
                    <text x="275" y="190" font-size="12" fill="#ff9800">K = ? cm</text>
                </svg>`
            },
            {
                question: "Segitiga ABC sebangun dengan segitiga PQR dengan perbandingan sisi 3:4. Jika luas segitiga ABC = 27 cm², berapakah luas segitiga PQR?",
                options: ["36 cm²", "48 cm²", "54 cm²", "64 cm²"],
                correct: 1,
                explanation: "Perbandingan luas = (3:4)² = 9:16 → Luas PQR = 27 × 16/9 = 48 cm²",
                diagram: `<svg width="400" height="200" viewBox="0 0 400 200">
                    <polygon points="80,150 130,70 180,150" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2"/>
                    <text x="125" y="65" font-size="12" fill="#9c27b0">A</text>
                    <text x="185" y="160" font-size="12" fill="#9c27b0">B</text>
                    <text x="75" y="160" font-size="12" fill="#9c27b0">C</text>
                    <text x="120" y="120" font-size="12" fill="#9c27b0">27 cm²</text>
                    
                    <polygon points="240,150 310,50 380,150" fill="#e0f2f1" stroke="#009688" stroke-width="2"/>
                    <text x="305" y="45" font-size="12" fill="#009688">P</text>
                    <text x="385" y="160" font-size="12" fill="#009688">Q</text>
                    <text x="235" y="160" font-size="12" fill="#009688">R</text>
                    <text x="300" y="120" font-size="12" fill="#009688">? cm²</text>
                    
                    <text x="160" y="180" font-size="14" fill="#333">Perbandingan sisi = 3:4</text>
                </svg>`
            },
            {
                question: "Dua segitiga sebangun memiliki sisi terpanjang 12 cm dan 18 cm. Jika tinggi segitiga pertama 8 cm, berapakah tinggi segitiga kedua?",
                options: ["10 cm", "12 cm", "14 cm", "16 cm"],
                correct: 1,
                explanation: "Perbandingan sisi = 12:18 = 2:3. Tinggi kedua = 8 × 3/2 = 12 cm",
                diagram: `<svg width="400" height="200" viewBox="0 0 400 200">
                    <polygon points="50,150 110,70 170,150" fill="#ffebee" stroke="#f44336" stroke-width="2"/>
                    <line x1="110" y1="70" x2="110" y2="150" stroke="#f44336" stroke-width="1" stroke-dasharray="3,3"/>
                    <text x="105" y="65" font-size="12" fill="#f44336">A</text>
                    <text x="175" y="160" font-size="12" fill="#f44336">B</text>
                    <text x="45" y="160" font-size="12" fill="#f44336">C</text>
                    <text x="85" y="110" font-size="10" fill="#f44336">8 cm</text>
                    <text x="100" y="170" font-size="10" fill="#f44336">12 cm</text>
                    
                    <polygon points="220,150 310,50 400,150" fill="#e8f5e8" stroke="#4caf50" stroke-width="2"/>
                    <line x1="310" y1="50" x2="310" y2="150" stroke="#4caf50" stroke-width="1" stroke-dasharray="3,3"/>
                    <text x="305" y="45" font-size="12" fill="#4caf50">P</text>
                    <text x="405" y="160" font-size="12" fill="#4caf50">Q</text>
                    <text x="215" y="160" font-size="12" fill="#4caf50">R</text>
                    <text x="285" y="100" font-size="10" fill="#4caf50">? cm</text>
                    <text x="300" y="170" font-size="10" fill="#4caf50">18 cm</text>
                </svg>`
            },
            {
                question: "Persegi ABCD sebangun dengan persegi PQRS. Jika diagonal AC = 8√2 cm dan diagonal PR = 12√2 cm, berapakah perbandingan luas kedua persegi?",
                options: ["2:3", "4:9", "8:18", "16:36"],
                correct: 1,
                explanation: "Perbandingan diagonal = 8√2:12√2 = 2:3. Perbandingan luas = (2:3)² = 4:9",
                diagram: `<svg width="400" height="200" viewBox="0 0 400 200">
                    <rect x="60" y="80" width="80" height="80" fill="#e3f2fd" stroke="#2196f3" stroke-width="2"/>
                    <line x1="60" y1="80" x2="140" y2="160" stroke="#2196f3" stroke-width="2"/>
                    <text x="55" y="75" font-size="12" fill="#2196f3">A</text>
                    <text x="145" y="75" font-size="12" fill="#2196f3">B</text>
                    <text x="145" y="175" font-size="12" fill="#2196f3">C</text>
                    <text x="55" y="175" font-size="12" fill="#2196f3">D</text>
                    <text x="85" y="115" font-size="10" fill="#2196f3">8√2 cm</text>
                    
                    <rect x="220" y="60" width="120" height="120" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
                    <line x1="220" y1="60" x2="340" y2="180" stroke="#ff9800" stroke-width="2"/>
                    <text x="215" y="55" font-size="12" fill="#ff9800">P</text>
                    <text x="345" y="55" font-size="12" fill="#ff9800">Q</text>
                    <text x="345" y="195" font-size="12" fill="#ff9800">R</text>
                    <text x="215" y="195" font-size="12" fill="#ff9800">S</text>
                    <text x="265" y="125" font-size="10" fill="#ff9800">12√2 cm</text>
                </svg>`
            }
        ];
        
        // Audio Functions
        function toggleMusic() {
            const music = document.getElementById('backgroundMusic');
            const toggle = document.getElementById('musicToggle');
            const visualizer = document.getElementById('musicVisualizer');
            
            if (musicEnabled) {
                music.pause();
                toggle.innerHTML = '🔇 Musik: OFF';
                toggle.className = 'mt-2 bg-gray-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-gray-600 transition-colors flex items-center';
                visualizer.style.display = 'none';
                musicEnabled = false;
            } else {
                music.play().catch(e => console.log('Audio play failed:', e));
                toggle.innerHTML = '🎵 Musik: ON <div class="music-visualizer ml-2" id="musicVisualizer"><div class="music-bar"></div><div class="music-bar"></div><div class="music-bar"></div><div class="music-bar"></div></div>';
                toggle.className = 'mt-2 bg-blue-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-blue-600 transition-colors flex items-center';
                musicEnabled = true;
            }
        }
        
        function playSound(soundId) {
            if (musicEnabled) {
                const sound = document.getElementById(soundId);
                sound.currentTime = 0;
                sound.play().catch(e => console.log('Sound play failed:', e));
            }
        }
        
        // Screen Management
        function showScreen(screenId) {
            const screens = ['openingScreen', 'roleSelection', 'playerLogin', 'hostLogin', 'hostDashboard', 'materialScreen', 'gameScreen', 'leaderboardScreen'];
            screens.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }
        
        function showOpeningScreen() {
            showScreen('openingScreen');
            // Stop background music when returning to menu
            document.getElementById('backgroundMusic').pause();
        }
        
        function showRoleSelection() {
            showScreen('roleSelection');
        }
        
        function showPlayerLogin() {
            showScreen('playerLogin');
        }
        
        function showHostLogin() {
            showScreen('hostLogin');
        }
        
        function showMaterial() {
            showScreen('materialScreen');
        }
        
        // Host Functions
        function loginHost() {
            const password = document.getElementById('hostPassword').value;
            if (password === 'ethomath2024') {
                showScreen('hostDashboard');
                updateHostDashboard();
            } else {
                alert('Password host salah!');
            }
        }
        
        function updateHostDashboard() {
            document.getElementById('activePlayersCount').textContent = hostStats.activePlayersCount;
            document.getElementById('gamesPlayedCount').textContent = hostStats.gamesPlayedCount;
            document.getElementById('averageScore').textContent = hostStats.gamesPlayedCount > 0 ? 
                Math.round(hostStats.totalScore / hostStats.gamesPlayedCount) : 0;
            
            const hostLeaderboard = document.getElementById('hostLeaderboard');
            if (leaderboard.length === 0) {
                hostLeaderboard.innerHTML = '<p class="text-gray-500 text-center py-8">Belum ada data pemain</p>';
            } else {
                hostLeaderboard.innerHTML = leaderboard.map((player, index) => `
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">${index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : '🏅'}</span>
                            <div>
                                <p class="font-semibold text-gray-800">${player.name}</p>
                                <p class="text-sm text-gray-600">${new Date(player.date).toLocaleDateString('id-ID')}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-xl font-bold text-purple-600">${player.score}</p>
                            <p class="text-sm text-gray-500">${player.score}/500 poin</p>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        // Timer Functions
        function startGameTimer() {
            timeRemaining = 900; // Reset to 15 minutes
            updateTimerDisplay();
            
            gameTimer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                // Change timer color when time is running low
                const timerElement = document.getElementById('gameTimer');
                if (timeRemaining <= 300) { // 5 minutes left
                    timerElement.className = 'text-2xl font-bold text-red-600 animate-pulse';
                } else if (timeRemaining <= 600) { // 10 minutes left
                    timerElement.className = 'text-2xl font-bold text-orange-600';
                }
                
                if (timeRemaining <= 0) {
                    clearInterval(gameTimer);
                    endGameByTimeout();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const timerText = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('gameTimer').textContent = timerText;
        }
        
        function stopGameTimer() {
            if (gameTimer) {
                clearInterval(gameTimer);
                gameTimer = null;
            }
        }
        
        function endGameByTimeout() {
            const status = document.getElementById('gameStatus');
            status.textContent = '⏰ Waktu habis! Game berakhir otomatis.';
            status.className = 'absolute top-4 left-4 bg-red-100 bg-opacity-90 px-4 py-2 rounded-xl text-lg font-semibold text-red-600 shadow-lg';
            
            // Disable all buttons
            const buttons = document.querySelectorAll('#questionOptions button');
            buttons.forEach(btn => btn.disabled = true);
            
            setTimeout(() => {
                endGame();
            }, 2000);
        }
        
        // Game Functions
        function startGame() {
            const playerName = document.getElementById('playerName').value.trim();
            if (!playerName) {
                alert('Silakan masukkan nama Anda terlebih dahulu!');
                return;
            }
            
            currentPlayer = playerName;
            currentQuestion = 0;
            currentScore = 0;
            
            // Update host stats
            hostStats.activePlayersCount++;
            hostStats.gamesPlayedCount++;
            localStorage.setItem('ethomath_host_stats', JSON.stringify(hostStats));
            
            // Shuffle questions
            gameQuestions = [...questionsDB].sort(() => Math.random() - 0.5).slice(0, 5);
            
            document.getElementById('currentPlayerName').textContent = currentPlayer;
            document.getElementById('currentScore').textContent = currentScore;
            
            showScreen('gameScreen');
            startGameTimer(); // Start the 15-minute timer
            showQuestion();
            resetBasketballCourt();
            
            // Start background music
            if (musicEnabled) {
                const music = document.getElementById('backgroundMusic');
                music.play().catch(e => console.log('Background music failed to play:', e));
            }
        }
        
        function resetBasketballCourt() {
            // Reset basketball
            const ball = document.getElementById('currentBall');
            ball.className = 'basketball';
            ball.style.left = '80px';
            ball.style.top = '150px';
            ball.style.opacity = '1';
            
            // Reset player
            const player = document.getElementById('currentPlayer');
            player.className = 'player';
            
            // Reset SWISH effect
            const swishEffect = document.getElementById('swishEffect');
            swishEffect.style.animation = 'none';
            
            // Update current player for this question
            updateCurrentPlayer();
        }
        
        function updateCurrentPlayer() {
            const playerData = basketballPlayers[currentQuestion];
            const playerAvatar = document.getElementById('currentPlayerAvatar');
            const playerNameElement = document.getElementById('currentPlayerName');
            const progressPlayerName = document.getElementById('progressPlayerName');
            
            playerAvatar.style.background = playerData.gradient;
            playerAvatar.textContent = playerData.avatar;
            playerNameElement.textContent = playerData.name;
            progressPlayerName.textContent = playerData.name;
        }
        
        function showQuestion() {
            if (currentQuestion >= 5) {
                endGame();
                return;
            }
            
            const question = gameQuestions[currentQuestion];
            const playerData = basketballPlayers[currentQuestion];
            
            document.getElementById('questionNumber').textContent = currentQuestion + 1;
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('progressQuestionNumber').textContent = currentQuestion + 1;
            
            // Display diagram
            const diagramContainer = document.getElementById('questionDiagram');
            diagramContainer.innerHTML = question.diagram || '';
            
            const optionsContainer = document.getElementById('questionOptions');
            optionsContainer.innerHTML = question.options.map((option, index) => `
                <button onclick="answerQuestion(${index})" class="p-4 bg-blue-50 hover:bg-blue-100 rounded-xl text-left transition-colors border-2 border-transparent hover:border-blue-300">
                    <span class="font-semibold text-blue-600">${String.fromCharCode(65 + index)}.</span> ${option}
                </button>
            `).join('');
            
            document.getElementById('gameStatus').textContent = `🏀 ${playerData.name} siap menembak!`;
            document.getElementById('gameStatus').className = 'absolute top-4 left-4 bg-white bg-opacity-90 px-4 py-2 rounded-xl text-lg font-semibold text-gray-700 shadow-lg';
            
            // Update current player display
            updateCurrentPlayer();
        }
        
        function answerQuestion(selectedIndex) {
            const question = gameQuestions[currentQuestion];
            const playerData = basketballPlayers[currentQuestion];
            const status = document.getElementById('gameStatus');
            
            // Disable all option buttons
            const buttons = document.querySelectorAll('#questionOptions button');
            buttons.forEach(btn => btn.disabled = true);
            
            // Get current ball and player
            const ball = document.getElementById('currentBall');
            const player = document.getElementById('currentPlayer');
            const swishEffect = document.getElementById('swishEffect');
            
            // Start shooting animation
            ball.classList.add('shooting');
            player.classList.add('shooting');
            
            setTimeout(() => {
                if (selectedIndex === question.correct) {
                    // Correct answer - shot scored
                    ball.classList.remove('shooting');
                    ball.classList.add('scored');
                    player.classList.remove('shooting');
                    player.classList.add('celebrating');
                    
                    // Show SWISH effect
                    swishEffect.style.animation = 'swishText 2s ease-out';
                    
                    // Play correct sound
                    playSound('correctSound');
                    
                    status.textContent = `🎉 SWISH! ${playerData.name} berhasil mencetak poin!`;
                    status.className = 'absolute top-4 left-4 bg-green-100 bg-opacity-90 px-4 py-2 rounded-xl text-lg font-semibold text-green-600 shadow-lg';
                    currentScore += 100;
                    document.getElementById('currentScore').textContent = currentScore;
                } else {
                    // Wrong answer - shot missed
                    ball.classList.remove('shooting');
                    ball.classList.add('missed');
                    player.classList.remove('shooting');
                    player.classList.add('disappointed');
                    
                    // Play wrong sound
                    playSound('wrongSound');
                    
                    status.textContent = `❌ Miss! ${playerData.name} gagal mencetak poin!`;
                    status.className = 'absolute top-4 left-4 bg-red-100 bg-opacity-90 px-4 py-2 rounded-xl text-lg font-semibold text-red-600 shadow-lg';
                }
            }, 2500);
            
            // Move to next question after animation
            setTimeout(() => {
                currentQuestion++;
                if (currentQuestion < 5) {
                    resetBasketballCourt();
                    showQuestion();
                } else {
                    endGame();
                }
            }, 4500);
        }
        
        function endGame() {
            // Stop the timer and music
            stopGameTimer();
            document.getElementById('backgroundMusic').pause();
            
            // Update host stats
            hostStats.totalScore += currentScore;
            hostStats.activePlayersCount = Math.max(0, hostStats.activePlayersCount - 1);
            localStorage.setItem('ethomath_host_stats', JSON.stringify(hostStats));
            
            // Add to leaderboard
            const playerData = {
                name: currentPlayer,
                score: currentScore,
                date: new Date().toISOString()
            };
            
            leaderboard.push(playerData);
            leaderboard.sort((a, b) => b.score - a.score);
            leaderboard = leaderboard.slice(0, 30); // Keep top 30
            localStorage.setItem('ethomath_leaderboard', JSON.stringify(leaderboard));
            
            showLeaderboard();
        }
        
        function showLeaderboard() {
            showScreen('leaderboardScreen');
            
            const leaderboardList = document.getElementById('leaderboardList');
            if (leaderboard.length === 0) {
                leaderboardList.innerHTML = '<p class="text-gray-500">Belum ada skor yang tercatat</p>';
            } else {
                leaderboardList.innerHTML = leaderboard.slice(0, 10).map((player, index) => `
                    <div class="flex items-center justify-between p-4 ${player.name === currentPlayer ? 'bg-yellow-50 border-2 border-yellow-300' : 'bg-gray-50'} rounded-xl">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">${index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : '🏅'}</span>
                            <div>
                                <p class="font-semibold text-gray-800">${player.name} ${player.name === currentPlayer ? '(Anda)' : ''}</p>
                                <p class="text-sm text-gray-600">${new Date(player.date).toLocaleDateString('id-ID')}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-xl font-bold text-purple-600">${player.score}</p>
                            <p class="text-sm text-gray-500">${player.score}/500 poin</p>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showOpeningScreen();
            
            // Set up audio elements with error handling
            const music = document.getElementById('backgroundMusic');
            music.addEventListener('error', function(e) {
                console.log('Background music failed to load');
                musicEnabled = false;
            });
            
            // Auto-enable music controls when user interacts
            document.addEventListener('click', function() {
                if (musicEnabled && music.paused) {
                    music.play().catch(e => console.log('Auto-play prevented'));
                }
            }, { once: true });
        });
    </script>
    </div> <!-- Close content wrapper -->
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'972f41f9563ceb9d',t:'MTc1NTgzMzA3MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
